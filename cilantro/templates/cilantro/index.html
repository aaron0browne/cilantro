{% extends "cilantro/base.html" %}

{% block scripts %}
    <script>
        var
            // Used by `environ.js` to correctly prefix URL paths
            SCRIPT_NAME = '{{ request.META.SCRIPT_NAME }}',

            // Used for non-safe requests, also defined in `environ.js`
            CSRF_TOKEN = '{{ csrf_token }}',

            // Namespace for shared App components
            App = {preferences: JSON.parse('{{ user_preferences|safe }}')};

        // Pre-configuration, everything is relative to Cilantro's path. For
        // integration of external scripts, create a contexted `require`
        // function. See http://requirejs.org/docs/api.html#multiversion.
        // Note that all existing scripts defined here can be used
        var require = {
            baseUrl: '{{ CILANTRO_JAVASCRIPT_URL }}',
            shim: {
                'underscore': {
                    exports: '_'
                },
                'backbone': {
                    deps: ['underscore', 'jquery'],
                    exports: 'Backbone'
                },
                'highcharts': {
                    exports: 'Highcharts'
                },
                'bootstrap': ['jquery'],
                'jquery.ui': ['jquery']
            }
        };
    </script>

    <script data-main=main src={{ CILANTRO_JAVASCRIPT_URL }}require.js></script>
{% endblock scripts %}

{% block header_links %}
    <li><a href={{ request.META.SCRIPT_NAME }}/ data-route=workspace>Workspace</a>
    <li><a href={{ request.META.SCRIPT_NAME }}/discover/ data-route=discover>Discover</a>
    <li><a href={{ request.META.SCRIPT_NAME }}/analyze/ data-route=analyze>Analyze</a>
    <li><a href={{ request.META.SCRIPT_NAME }}/review/ data-route=review>Review</a>
{% endblock header_links %}

{% block subnav_content %}
    <ul class="nav pull-left">
        <li><button class=btn data-toggle=panel data-target=#data-filters-panel title=Filters>
                <i class=icon-filter alt=Filters></i> Filters
            </button>
    </ul>
    <ul class="nav pull-right">
        <li><button class=btn data-toggle=panel data-target=#data-conditions-panel>
                <i class=icon-tasks></i>
            </button>
    </ul>
{% endblock subnav_content %}


{% block content %}
    <div id=main-area class=scrollable-column>
        <div class=inner></div>
    </div>

    <div id=data-conditions-panel class="panel panel-right closed">
        <div class=panel-toggle></div>

        <div class="inner panel-content">
            <ul id=data-conditions class="condition-list"></ul>
            <div class=btn-toolbar>
                <button class="btn btn-danger btn-small">Clear</button>
            </div>
        </div>
    </div>
{% endblock content %}
