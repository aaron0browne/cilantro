{% load url from future %}
<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="lt-ie9 lt-ie8 lt-ie7" lang=en> <![endif]-->
<!--[if IE 7]> <html class="lt-ie9 lt-ie8" lang=en> <![endif]-->
<!--[if IE 8]> <html class="lt-ie9" lang=en> <![endif]-->
<!--[if gt IE 8]><!--> <html lang=en> <!--<![endif]-->
<head>
    <meta charset=utf-8>

    <!-- Use the .htaccess and remove these lines to avoid edge case issues.
             More info: h5bp.com/i/378 -->
    <meta http-equiv=X-UA-Compatible content=IE=edge,chrome=1>

    <title>{% block head_title %}{{ CILANTRO_CONFIG.title }}{% endblock %}</title>
    <meta name=description content="{{ CILANTRO_CONFIG.subtitle }}">

    <!-- Mobile viewport optimized: h5bp.com/viewport -->
    <meta name=viewport content=width=device-width>

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory: mathiasbynens.be/notes/touch-icons -->

    {% block styles %}
        <link rel=stylesheet href={{ CILANTRO_CSS_URL }}style.css>
    {% endblock %}

    <!-- More ideas for your <head> here: h5bp.com/d/head-Tips -->
</head>
<body>
    <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you support IE 6.
             chromium.org/developers/how-tos/chrome-frame-getting-started -->
    <!--[if lt IE 9]><p class=chromeframe>Your browser is <em>ancient!</em> <a href=http://browsehappy.com/>Upgrade to a different browser</a> or <a href=http://www.google.com/chromeframe/?redirect=true>install Google Chrome Frame</a> to experience this site.</p><![endif]-->

    <!-- Add your site or application content here -->
    {% block header %}
        <div class="navbar navbar-fixed-top">
            <div class=navbar-inner>
                <div class=container-fluid>
                    {% block header_content %}
                    <a class=brand href=/>{% firstof CILANTRO_CONFIG.title site.name site.domain "Cilantro" %}
                        {% if CILANTRO_CONFIG.label %}<span class="label label-info">{{ CILANTRO_CONFIG.label }}</span>{% endif %}</a>
                        {% if CILANTRO_CONFIG.subtitle %}
                        <span class=subtitle>{{ CILANTRO_CONFIG.subtitle }}</span>
                        {% endif %}
                        <ul class=nav>
                            {% block header_links %}{% endblock %}
                        </ul>
                        <ul class="nav pull-right">
                            <li class=dropdown>
                                <a href=# class=dropdown-toggle data-toggle=dropdown>
                                    <i class="icon-user icon-white"></i> Account <b class=caret></b>
                                </a>
                                <ul class=dropdown-menu>
                                    <li><a href={% url "admin:index" %}>Admin</a></li>
                                    {% if user.is_authenticated %}
                                        <li class=divider></li>
                                        <li><a href={% url "admin:logout" %}>Logout</a></li>
                                    {% endif %}
                                </ul>
                            </li>
                        </ul>
                    {% endblock %}
                </div>
            </div>
        </div> {% endblock %}

    {% block subnav %}
        <div id=subnav class="navbar navbar-fixed-top">
            <div class=navbar-inner>
                <div class=container-fluid>{% block subnav_content %}{% endblock %}</div>
            </div>
        </div>
    {% endblock %}

    <div class=container-fluid>
        <div class=row-fluid>
            {% block content %}
            {% endblock content %}
        </div>
    </div>

    {% block extra_content %}{% endblock %}


    <!-- JavaScript at the bottom for fast page loading: http://developer.yahoo.com/performance/rules.html#js_bottom -->

    {% block scripts %}
        <script>
            var
                // Used by `environ.js` to correctly prefix URL paths
                SCRIPT_NAME = '{{ request.META.SCRIPT_NAME }}',

                // Used for non-safe requests, also defined in `environ.js`
                CSRF_TOKEN = '{{ csrf_token }}';


            // Pre-configuration, everything is relative to Cilantro's path. For
            // integration of external scripts, create a contexted `require`
            // function. See http://requirejs.org/docs/api.html#multiversion.
            // Note that all existing scripts defined here can be used
            var require = {
                baseUrl: '{{ CILANTRO_JAVASCRIPT_URL }}',
                shim: {
                    'underscore': {
                        exports: '_'
                    },
                    'backbone': {
                        deps: ['underscore', 'jquery'],
                        exports: 'Backbone'
                    },
                    'highcharts': {
                        exports: 'Highcharts'
                    },
                    'bootstrap': ['jquery'],
                    'jquery.ui': ['jquery']
                }
            };
        </script>
        <script data-main=environ src={{ CILANTRO_JAVASCRIPT_URL }}require.js></script>
    {% endblock %}

    <!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
             mathiasbynens.be/notes/async-analytics-snippet -->
    {% if CILANTRO_CONFIG.google_analytics %}
    <script>
        var _gaq=[['_setAccount','{{ CILANTRO_CONFIG.google_analytics }}'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>
    {% endif %}
</body>
</html>
