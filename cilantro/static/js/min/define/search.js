define(["cilantro/define/events","cilantro/define/criteria2","cilantro/rest/resource"],function(a,b,c){var d=['<div data-id="<%= this.id %>">',"<b><%= this.name %></b><br>","<span><%= this.category.name %></span>","</div>"].join(""),e;$(function(){function g(){var a=f.results.outerWidth(),b=f.search.offset(),c=f.search.outerHeight(),d=f.search.outerWidth();f.results.css({left:b.left-(a-d)/2,top:b.top+c+5})}var f={search:$("#search"),results:$('<div id="search-results"></div>').appendTo("body"),noresults:$('<p style="font-style:italic">No Results Found</p>')};b.ready(function(){e=(new c({store:b._,template:d})).ready(function(){f.results.html(this.dom),g()}),f.search.autocomplete2({success:function(a,b){f.noresults.detach(),f.results.show().children().hide(),b.length?$.each(b,function(){e.store[this]&&e.store[this].show()}):f.noresults.prependTo(f.results)}},null,50)}),f.results.entered=!1,f.search.bind({blur:function(a){f.search.focused=!1,f.results.entered||f.results.trigger("mouseleave")},focus:function(a){f.search.focused=!0;var b=f.search.val();b&&b!==f.search.attr("placeholder")&&f.results.fadeIn("fast")}}),f.results.bind({mouseenter:function(a){f.results.entered=!0},mouseleave:function(a){f.results.entered=!1,f.search.focused||f.results.fadeOut("fast")}}),f.results.delegate("div","click",function(b){var c=$(this);c.trigger(a.ACTIVATE_CRITERION,[c.data("id")])}),$(window).bind("resize",function(a){g()})});return e})