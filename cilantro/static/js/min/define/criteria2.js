define(["cilantro/define/events","cilantro/rest/resource","cilantro/define/conceptmanager","cilantro/define/criteriamanager","cilantro/define/description"],function(a,b,c,d){var e=['<div data-id="<%= this.id %>">','<span class="name"><%= this.name %></span>','<span class="description"><%= this.description %></span>',"</div>"].join(""),f={criteria:$("#criteria"),pluginPanel:$("#plugin-panel")},g=(new b({template:e,url:f.criteria.data("uri")})).ready(function(){f.criteria.html(this.dom).fadeIn()});f.criteria.current=null,f.criteria.bind(a.ACTIVATE_CATEGORY,function(a,b){g.ready(function(){$.each(this.store,function(){this.data("category").id===b?this.show():this.hide()})})}),f.criteria.bind(a.ACTIVATE_CRITERION+" ShowConceptEvent",function(b,e){if(f.criteria.current===e)return!1;f.criteria.current=e,g.ready(function(){var b=this.store[e];b.addClass("active"),b.siblings().removeClass("active");var g=b.data();f.criteria.trigger(a.SYNC_CATEGORY,[g.category.id,e]);var h=d.retrieveCriteriaDS(e);c.isConceptLoaded(e)?c.show({id:e},h):$.ajax({url:b.data("uri"),dataType:"json",beforeSend:function(){f.pluginPanel.block()},complete:function(){f.pluginPanel.unblock()},success:function(a){c.show(a,h)}})})});var h=null;f.criteria.delegate("div","mouseenter",function(){clearTimeout(h);var b=this;h=setTimeout(function(){$(b).trigger(a.ACTIVATE_DESCRIPTION,["right"])},700)}),f.criteria.delegate("div","mouseleave",function(){clearTimeout(h),$(this).trigger(a.DEACTIVATE_DESCRIPTION,[200])}),f.criteria.delegate("div","click",function(b){clearTimeout(h),$(this).trigger(a.ACTIVATE_CRITERION,[$(this).data("id")]),$(this).trigger(a.DEACTIVATE_DESCRIPTION)});return g})