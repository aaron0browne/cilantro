define(["cilantro/define/events","cilantro/rest/resource","cilantro/define/conceptmanager","cilantro/define/criteriamanager","cilantro/define/description"],function(a,b,c,d){var e=['<div data-id="<%= this.id %>">','<span class="name"><%= this.name %></span>','<span class="description"><%= this.description %></span>',"</div>"].join(""),f=new b({template:e});$(function(){var b={criteria:$("#criteria"),pluginPanel:$("#plugin-panel")};f.url=b.criteria.data("uri"),f.ready(function(){b.criteria.html(this.dom).fadeIn()}),b.criteria.current=null,b.criteria.bind(a.ACTIVATE_CATEGORY,function(a,b){f.ready(function(){$.each(this.store,function(){this.data("category").id===b?this.show():this.hide()})})}),b.criteria.bind(a.ACTIVATE_CRITERION+" ShowConceptEvent",function(e,g){if(b.criteria.current===g)return!1;b.criteria.current=g,f.ready(function(){var e=this.store[g];e.addClass("active"),e.siblings().removeClass("active");var f=e.data();b.criteria.trigger(a.SYNC_CATEGORY,[f.category.id,g]);var h=d.retrieveCriteriaDS(g);c.isConceptLoaded(g)?c.show({id:g},h):$.ajax({url:e.data("uri"),dataType:"json",beforeSend:function(){b.pluginPanel.block()},complete:function(){b.pluginPanel.unblock()},success:function(a){c.show(a,h)}})})});var e=null;b.criteria.delegate("div","mouseenter",function(){clearTimeout(e);var b=this;e=setTimeout(function(){$(b).trigger(a.ACTIVATE_DESCRIPTION,["right"])},700)}),b.criteria.delegate("div","mouseleave",function(){clearTimeout(e),$(this).trigger(a.DEACTIVATE_DESCRIPTION,[200])}),b.criteria.delegate("div","click",function(b){clearTimeout(e),$(this).trigger(a.ACTIVATE_CRITERION,[$(this).data("id")]),$(this).trigger(a.DEACTIVATE_DESCRIPTION)})});return f})