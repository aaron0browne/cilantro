define(["cilantro/define/events","cilantro/rest/resource","cilantro/define/conceptmanager","cilantro/define/criteriamanager","cilantro/define/description"],function(a,b,c,d){var e=['<div data-id="<%= this.id %>">','<span class="name"><%= this.name %></span>','<span class="description"><%= this.description %></span>',"</div>"].join(""),f;$(function(){var g={criteria:$("#criteria"),pluginPanel:$("#plugin-panel")};f=(new b({url:g.criteria.data("uri"),template:e})).ready(function(){g.criteria.html(this.dom)}),g.criteria.current=null,g.criteria.bind(a.ACTIVATE_CATEGORY,function(a,b){f.ready(function(){$.each(this.store,function(){this.data("category").id===b?this.show():this.hide()})})}),g.criteria.bind(a.ACTIVATE_CRITERION+" ShowConceptEvent",function(b,e){if(g.criteria.current===e)return!1;g.criteria.current=e,f.ready(function(){var b=this.store[e];b.addClass("active"),b.siblings().removeClass("active");var f=b.data();g.criteria.trigger(a.SYNC_CATEGORY,[f.category.id,e]);var h=d.retrieveCriteriaDS(e);c.isConceptLoaded(e)?c.show({id:e},h):$.ajax({url:b.data("uri"),dataType:"json",beforeSend:function(){g.pluginPanel.block()},complete:function(){g.pluginPanel.unblock()},success:function(a){c.show(a,h)}})})});var h=null;g.criteria.delegate("div","mouseenter",function(){clearTimeout(h);var b=this;h=setTimeout(function(){$(b).trigger(a.ACTIVATE_DESCRIPTION,["right"])},700)}),g.criteria.delegate("div","mouseleave",function(){clearTimeout(h),$(this).trigger(a.DEACTIVATE_DESCRIPTION,[200])}),g.criteria.delegate("div","click",function(b){clearTimeout(h),$(this).trigger(a.ACTIVATE_CRITERION,[$(this).data("id")]),$(this).trigger(a.DEACTIVATE_DESCRIPTION)})});return f})