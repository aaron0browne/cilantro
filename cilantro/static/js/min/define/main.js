define("define/events",{ACTIVATE_DESCRIPTION:"activate-description",DEACTIVATE_DESCRIPTION:"deactivate-description",ACTIVATE_CATEGORY:"activate-category",SYNC_CATEGORY:"sync-category",ACTIVATE_CRITERION:"activate-criterion"});var Base=function(){};Base.extend=function(a,b){var c=Base.prototype.extend;Base._prototyping=!0;var d=new this;c.call(d,a),d.base=function(){},delete Base._prototyping;var e=d.constructor,f=d.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==f)this._constructing=!0,e.apply(this,arguments),delete this._constructing;else if(arguments[0]!=null)return(arguments[0].extend||c).call(arguments[0],d)};f.ancestor=this,f.extend=this.extend,f.forEach=this.forEach,f.implement=this.implement,f.prototype=d,f.toString=this.toString,f.valueOf=function(a){return a=="object"?f:e.valueOf()},c.call(f,b),typeof f.init=="function"&&f.init();return f},Base.prototype={extend:function(a,b){if(arguments.length>1){var c=this[a];if(c&&typeof b=="function"&&(!c.valueOf||c.valueOf()!=b.valueOf())&&/\bbase\b/.test(b)){var d=b.valueOf();b=function(){var a=this.base||Base.prototype.base;this.base=c;var b=d.apply(this,arguments);this.base=a;return b},b.valueOf=function(a){return a=="object"?b:d},b.toString=Base.toString}this[a]=b}else if(a){var e=Base.prototype.extend;!Base._prototyping&&typeof this!="function"&&(e=this.extend||e);var f={toSource:null},g=["constructor","toString","valueOf"],h=Base._prototyping?0:1;while(i=g[h++])a[i]!=f[i]&&e.call(this,i,a[i]);for(var i in a)f[i]||e.call(this,i,a[i])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(a,b,c){for(var d in a)this.prototype[d]===undefined&&b.call(c,a[d],d,a)},implement:function(){for(var a=0;a<arguments.length;a++)typeof arguments[a]=="function"?arguments[a](this.prototype):this.prototype.extend(arguments[a]);return this},toString:function(){return String(this.valueOf())}}),define("lib/base",function(){}),define("rest/resource",["lib/base"],function(){Resource=Base.extend({url:"",dataType:"json",timeout:5e3,interval:15,uid:"id",_setup:function(a){if(this.loaded!==!0){var b=$.isArray(a)?[]:{};this._=$.extend(!0,b,a),this.store={},this.template&&(this.dom=this.render(this.template)),this.loaded=!0}},_fetch:function(){var a=this,b={type:"GET",url:this.url,dataType:this.dataType,success:function(b){a._setup(b)}};this.xhr=$.ajax(b)},ready:function(a){a=a||function(){};if(this.loaded)a.apply(this);else{attempts=arguments[1]||parseInt(this.timeout/this.interval),this.store&&!this.xhr&&this._setup(this.store),this.url&&!this.xhr&&this._fetch();if(!--attempts)throw new Error("Failed to get a response");var b=this;setTimeout(function(){b.ready(a,attempts)},15)}return this},render:function(a){arguments.length===1&&typeof a=="object"?(data=a,a=this.template):data=arguments[1]||this._,$.isArray(data)||(data=[data]),typeof a=="string"&&(a=$.jqotec(a));var b,c,d,e,f,g=[];for(var h=0,i=data.length;h<i;h++)e=data[h],c=$.jqote(a,e),d=$(c).data(e),b=this.uid?e[this.uid]:h,this.store[b]=d,g.push.apply(g,d.toArray());return $(g)},grep:function(a,b){var c=arguments[3]||this._;c=$.isArray(c)?c:[c];var d;this.ready(function(){d=$.grep(c,function(c,d){return $(c).data(a)===b})});return d}});return Resource}),define("define/categories",["define/events","rest/resource"],function(a,b){var c=['<span id="tab-<%= this.name.toLowerCase() %>" ','class="tab" data-id="<%= this.id %>">','<div class="icon"></div>',"<span><%= this.name %></span>","</span>"].join(""),d;$(function(){var e={categories:$("#categories"),subcategories:$("#subcategories")};e.categories.current=null,d=(new b({url:e.categories.data("uri"),template:c})).ready(function(){e.categories.html(this.dom),this.dom.first().click()}),e.categories.bind(a.ACTIVATE_CATEGORY,function(b,c){if(e.categories.current===c)return!1;e.categories.current=c,d.ready(function(){var b=this.store[c];b.addClass("active"),b.siblings().removeClass("active");var d=b.data("_state");!!d&&d.criterion&&e.categories.trigger(a.ACTIVATE_CRITERION,[d.criterion])})}),e.categories.bind(a.SYNC_CATEGORY,function(b,c,f){d.ready(function(){var b=this.store[c];b.data("_state",{criterion:f}),e.categories.trigger(a.ACTIVATE_CATEGORY,[c])});return!1}),e.categories.delegate("span.tab","click",function(b){$(b.currentTarget).trigger(a.ACTIVATE_CATEGORY,[$(this).data("id")])}),e.subcategories.delegate("span","click",function(a){var b=$(this);b.addClass("active").siblings().removeClass("active");return!1})});return d}),define("define/viewelement",["lib/base"],function(){var a=Base.extend({constructor:function(a,b){this.state="INIT",this.ds={},this.viewset=a,this.concept_pk=b,this.dom=$(),this.render(),this.dom.delegate("input,select,textarea","change keyup",$.proxy(this.elementChanged,this)),this.dom.bind("UpdateElementEvent",$.proxy(this.updateElement,this)),this.dom.bind("UpdateDSEvent",$.proxy(this.updateDS,this)),this.dom.bind("GainedFocusEvent",$.proxy(this.gainedFocus,this)),this.dom.bind("LostFocusEvent",$.proxy(this.lostFocus,this)),this.dom.bind("RegisterElementsEvent",$.proxy(this.registerElements,this)),this.dom.bind("HideDependentsEvent",$.proxy(this.hideDependents,this)),this.dom.bind("ShowDependentsEvent",$.proxy(this.showDependents,this))},render:function(){throw{name:"FunctionNotImplementedException",message:'This function needs to set the "dom" attribute of this object.'}},elementChanged:function(a){throw{name:"FunctionNotImplementedException",message:"This function needs to trigger an ElementChangedEvent with the new value of the evt.target."}},updateElement:function(a,b){throw{name:"FunctionNotImplementedException",message:"This function needs to find the element whose name = element.name, and set its value to element.value."}},updateDS:function(a,b){for(var c in b)this.updateElement("UpdateElementEvent",{name:c,value:b[c]});this.ds=b,this.dom.data("datasource",b)},registerElements:function(a){$("input,select",this.dom).change()},gainedFocus:function(){this.state="ONSCREEN"},lostFocus:function(){this.state="OFFSCREEN"},hideDependents:function(a){this.dom[0]!==(a.originalEvent?a.originalEvent.target:a.target)&&this.dom.has(a.target).length===0&&$("input,select,label",this.dom).attr("disabled","true").change()},showDependents:function(a){this.dom[0]!==(a.originalEvent?a.originalEvent.target:a.target)&&this.dom.has(a.target).length===0&&$("input,select,label",this.dom).filter(":disabled").removeAttr("disabled").change()}});return a}),define("define/form",["define/viewelement"],function(a){var b=['<option selected id="<%=this.field_id%>" value="range">is between</option>','<option id="<%=this.field_id%>" value="-range">is not between</option>','<option id="<%=this.field_id%>" value="lt">is less than</option>','<option id="<%=this.field_id%>" value="gt">is greater than</option>','<option id="<%=this.field_id%>" value="lte">is less than or equal to</option>','<option id="<%=this.field_id%>" value="gte">is greater than or equal to</option>','<option id="<%=this.field_id%>" value="exact">is equal to</option>','<option id="<%=this.field_id%>" value="-exact">is not equal to</option>','<option id="<%=this.field_id%>" value="isnull">is null</option>','<option id="<%=this.field_id%>" value="-isnull">is not null</option>'],c=['<option selected value="in">is equal to</option>','<option value="-in">is not equal to</option>'],d=['<option selected value="iexact">is equal to</option>','<option value="-iexact">is not equal to</option>','<option value="in">is one of</option>','<option value="-in">is not one of</option>','<option value="icontains">contains</option>','<option value="-icontains">does not contain</option>'],e=a.extend({constructor:function(a,b){this.base(a,b),$('input[data-validate="date"]',this.dom).datepicker({changeMonth:!0,changeYear:!0})},render:function(){var a={nullboolean:e.nullboolean_tmpl,"boolean":e.boolean_tmpl,date:e.number_tmpl,number:e.number_tmpl,string:e.string_tmpl,"string-list":e.stringlist_tmpl},b=this.dom=$('<span class="form_container"></span>'),c=this.concept_pk;$.each(this.viewset.fields,function(d,f){var g=[a[f.datatype]];g.unshift($.jqotec("<p>")),g.push($.jqotec("</p>")),f.hasOwnProperty("pk")||g.push(e.pk_tmpl),$.each(["choices","pkchoices"],function(a,b){f[b]&&$.each(f[b],function(a,c){f[b][a][0]===null&&(f[b][a][0]="null"),f[b][a][1]==="None"&&(f[b][a][1]="No Data")})});var h=null,i=null;if(f.hasOwnProperty("pk"))h=c+"_"+f.pk;else{var j=$.map(f.pkchoices,function(a,b){return parseInt(a[0])});j.sort(),i=j.join("OR"),h=c+"_"+i}var k=$($.jqote(g,{datatype:f.datatype,choices:f.choices,field_id:h,label:f.name,pkchoices:f.pkchoices,pkchoice_label:f.pkchoice_label,pkchoice_id:i,optional:f.hasOwnProperty("optional")?f.optional:!1,"default":f.hasOwnProperty("default")?f["default"]:0,pkchoice_default:f.hasOwnProperty("pkchoice_default")?f.pkchoice_default:0}));k.children().not("span").wrap("<span/>"),b.append(k)})},elementChanged:function(a){var b=$(a.target);if($.contains(this.dom.get(0),b.get(0))){var c,d,f=this.dom,g=this;switch(a.target.type){case"checkbox":c=a.target.checked,c=b.is(":visible")&&b.is(":enabled")?c:undefined,f.trigger("ElementChangedEvent",[{name:a.target.name,value:c}]);break;case"select-one":case"select-multiple":case"select":var h=[],i=null,j=e.opRe.exec(b.attr("name"));j&&(i=$("[name^="+j[1]+"_"+j[2]+"]",f).not(b).not("span")),$("option",$(a.target)).each(function(a,b){if(b.selected){h.push(b.value);var c={decimal:1,number:1,date:1};if(i&&i.attr("data-validate")in c)b.value.search(/range/)<0?b.value.search(/null/)<0?($("input[name="+b.id+"_input1],",f).hide().change(),$("label[for="+b.id+"_input1]",f).hide(),$("input[name="+b.id+"_input0]",f).show().change()):($("input[name="+b.id+"_input1],",f).hide().change(),$("label[for="+b.id+"_input1]",f).hide(),$("input[name="+b.id+"_input0]",f).hide().change()):($("input[name="+b.id+"_input1]",f).show().change(),$("label[for="+b.id+"_input1]",f).show(),$("input[name="+b.id+"_input0]",f).show().change());else if(i&&i.attr("type")in{text:1,textarea:1})if(b.value.search(/exact/)<0||i.attr("type")!=="textarea"){if(b.value.search(/^-?in$/)>=0&&i.attr("type")==="text")if(i.data("switch"))i.data("switch").data("switch",i),i.before(i.data("switch")).detach(),i.data("switch").keyup();else{var e=$('<textarea rows="8" id="'+i.attr("id")+'" name="'+i.attr("name")+'" cols="25"></textarea>').data("switch",i);i.before(e).detach(),d=f.data("datasource")||{},d[i.attr("name")]instanceof Array?g.updateElement(null,{name:i.attr("name"),value:d[i.attr("name")]}):typeof d[i.attr("name")]==="string"?g.updateElement(null,{name:i.attr("name"),value:[d[i.attr("name")]]}):g.updateElement(null,{name:i.attr("name"),value:[]}),e.keyup()}}else i.data("switch").data("switch",i),i.before(i.data("switch")).detach(),i.data("switch").keyup()}});if(a.target.type==="select-multiple"){var k=[],l=h.length;for(var m=0;m<l;m++){var n=h[m];k.push(n in e.s_to_primative_map?e.s_to_primative_map[n]:n)}c=k}else c=h[0]in e.s_to_primative_map?e.s_to_primative_map[h[0]]:h[0];b.is("[data-optional=true]")&&(c=$.type(c)in{string:1,array:1}&&c.length===0?undefined:c),c=this.state==="INIT"&&b.css("display")!=="none"||b.is(":visible")&&b.is(":enabled")?c:undefined,f.trigger("ElementChangedEvent",[{name:a.target.name,value:c}]);break;case"textarea":c=this.state==="INIT"&&b.css("display")!=="none"||b.is(":visible")&&b.is(":enabled")?b.val().split("\n"):undefined,f.trigger("ElementChangedEvent",[{name:a.target.name,value:c}]);break;default:var o=$(a.target).closest("p").find("select").val(),p=a.target.name.substr(0,a.target.name.length-1);switch(b.attr("data-validate")){case"number":case"decimal":case"date":var q=b.attr("data-validate"),r=$("input[name="+p+"0]",f),s=$("input[name="+p+"1]",f),t;if(q==="date")var u=new Date(r.val()),v=new Date(s.val());else var u=parseFloat(r.val()),v=parseFloat(s.val());q!=="date"&&b.is(":visible")&&isNaN(Number(b.val()))?(t=$.Event("InvalidInputEvent"),b.trigger(t)):$(a.target).hasClass("invalid")?(t=$.Event("InputCorrectedEvent"),b.trigger(t)):o.search(/range/)>=0&&u>v?(t=$.Event("InvalidInputEvent"),t.reason="badrange",t.message="First input must be less than second input.",b.parent().trigger(t)):$(a.target).parent().hasClass("invalid_badrange")&&(s.css("display")==="none"||u<v)&&(t=$.Event("InputCorrectedEvent"),t.reason="badrange",b.parent().trigger(t));break;default:}c=this.state==="INIT"&&b.css("display")!=="none"||b.is(":visible")&&b.is(":enabled")?b.val():undefined,f.trigger("ElementChangedEvent",[{name:a.target.name,value:c}])}a.stopPropagation()}},updateElement:function(a,b){var c=$("[name="+b.name+"]",this.dom);if(c.length!==0){var d=c.attr("type");switch(d){case"checkbox":c.attr("checked",b.value);break;case"select-multiple":var e=$.isArray(b.value)?b.value:[b.value];$("option",c).each(function(a,b){var c=$.map(e,function(a,b){return typeof a in{string:1,number:1}?a:String(a)});$.inArray(b.value,c)!=-1?b.selected=!0:b.selected=!1});break;case"textarea":c.val(b.value.join("\n"));break;default:if($.isArray(b.value))break;c.attr("value",typeof b.value in{string:1,number:1}?b.value:String(b.value))}}}},{s_to_primative_map:{"true":!0,"false":!1,"null":null},opRe:/^(\d*)_(\d+(?:OR\d+)*)_operator$/,nullboolean_tmpl:$.jqotec(['<label for="<%=this.field_id%>"><%=this.label%></label>','<select data-datatype="nullboolean"data-optional="<%=this.optional%>"  multiple id ="<%=this.field_id%>" name="<%=this.field_id%>">','<option <%=this["default"]===true?"selected":""%> value="true">Yes</option>','<option <%=this["default"]===false?"selected":""%> value="false">No</option>','<option <%=this["default"]===null?"selected":""%> value="null">No Data</option>',"</select>"].join("")),boolean_tmpl:$.jqotec(["<%if (this.optional) {%>",'<label for="<%=this.field_id%>"><%=this.label%></label>','<select data-datatype="boolean" data-optional="<%=this.optional%>" id ="<%=this.field_id%>" name="<%=this.field_id%>">','<option value="">No Preference</option>','<option <%=this["default"]===true?"selected":""%> value="true">Yes</option>','<option <%=this["default"]===false?"selected":""%> value="false">No</option>',"</select>","<%} else {%>",'<input type="checkbox" name="<%=this.field_id%>" value="<%=this.field_id%>" <%= this["default"] ? "checked":""%>/>','<label for="<%=this.field_id%>"><%=this.label%></label>',"<%}%>"].join("")),number_tmpl:$.jqotec(['<label for="<%=this.field_id%>"><%=this.label%></label>','<select id="<%=this.field_id%>_operator" name="<%=this.field_id%>_operator">',b.join(""),"</select>",'<span class="input_association" name="<%=this.field_id%>_input_assoc">','<input data-validate="<%=this.datatype%>" id="<%=this.field_id%>_input0" type="text" name="<%=this.field_id%>_input0" size="5">','<label for="<%=this.field_id%>_input1">and</label>','<input data-validate="<%=this.datatype%>" id="<%=this.field_id%>_input1" type="text" name="<%=this.field_id%>_input1" size="5">',"</span>"].join("")),string_tmpl:$.jqotec(["<% if (this.choices) {%>",'<label for="<%=this.field_id%>"><%=this.label%></label>','<select id="<%=this.field_id%>-operator" name="<%=this.field_id%>_operator">',c.join(""),"</select>",'<select multiple="multiple" id="<%=this.field_id%>-value" name="<%=this.field_id%>" size="3" data-optional="<%=this.optional%>" >',"<% for (var index = 0; index < this.choices.length; index++) { %>",'<option value="<%=this.choices[index][0]%>"><%=this.choices[index][1]%></option>',"<%}%>","</select>","<%} else {%>",'<label for="<%=this.field_id%>"><%=this.label%></label>','<select id="<%=this.field_id%>-operator" name="<%=this.field_id%>_operator">',d.join(""),"</select>",'<input data-optional="<%=this.optional%>" type="text" id="<%=this.field_id%>_text" name="<%=this.field_id%>" size = "10">',"<%}%>"].join("")),stringlist_tmpl:$.jqotec(['<label for="<%=this.field_id%>"><%=this.label%></label>','<select id="<%=this.field_id%>-operator" name="<%=this.field_id%>_operator">',c.join(""),"</select>",'<textarea data-optional="<%=this.optional%>" id="<%=this.field_id%>_text" name="<%=this.field_id%>" rows="8" cols="25"></textarea>'].join("")),pk_tmpl:$.jqotec(['<p><label for="<%=this.pkchoice_id%>"><%=this.pkchoice_label%></label>','<select id="<%=this.pkchoice_id%>" name="<%=this.pkchoice_id%>">',"<% for (index in this.pkchoices) { %>",'<option value="<%=this.pkchoices[index][0]%>" <%=this.pkchoices[index][0]==this.pkchoice_default ? "selected":""%>><%=this.pkchoices[index][1]%></option>',"<%}%>","</select></p>"].join(""))});return e}),function(){function r(a){var b=[],c=[],d;for(d=0;d<a.length;d++)b[d]=a[d].plotX,c[d]=a[d].plotY;this.xdata=b,this.ydata=c,a=[],this.y2=[];var e=c.length;this.n=e,this.y2[0]=0,this.y2[e-1]=0,a[0]=0;for(d=1;d<e-1;d++){var f=b[d+1]-b[d-1];f=(b[d]-b[d-1])/f;var g=f*this.y2[d-1]+2;this.y2[d]=(f-1)/g,a[d]=(c[d+1]-c[d])/(b[d+1]-b[d])-(c[d]-c[d-1])/(b[d]-b[d-1]),a[d]=(6*a[d]/(b[d+1]-b[d-1])-f*a[d-1])/g}for(b=e-2;b>=0;b--)this.y2[b]=this.y2[b]*this.y2[b+1]+a[b]}function q(f,i){function bq(){var a="onreadystatechange";G||s.readyState=="complete"?(_(),br(f.series||[],function(a){p(a)}),bU.inverted=cp=e(cp,f.chart.inverted),bU.plotSizeX=cf=cp?ca:ce,bU.plotSizeY=cg=cp?ce:ca,bU.tracker=ch=new n(bU,f.tooltip),J(),br(co,function(a){a.translate(),a.setTooltipPoints()}),bU.render=bc,bc(),by(bU,"load"),i&&i(bU)):s.attachEvent(a,function(){s.detachEvent(a,arguments.callee),bq()})}function bp(){var a=co.length;bx(t,"unload",bp),bx(bU);for(br(cm,function(a){bx(a)});a--;)co[a].destroy();bQ.onmousedown=bQ.onmousemove=bQ.onmouseup=bQ.onclick=null,bQ.parentNode.removeChild(bQ),bQ=null,clearInterval(cs);for(a in bU)delete bU[a]}function bc(){var b,c=f.labels,d=f.credits,e=bv.borderWidth||0,g=bv.backgroundColor,h=bv.plotBackgroundColor,i=bv.plotBackgroundImage;b=2*e+(bv.shadow?8:0),(e||g)&&cq.rect(b/2,b/2,bS-b,bT-b,bv.borderRadius,e).attr({stroke:bv.borderColor,"stroke-width":e,fill:g||X}).add().shadow(bv.shadow),h&&cq.rect(bL,bC,ce,ca,0).attr({fill:h}).add().shadow(bv.plotShadow),i&&cq.image(i,bL,bC,ce,ca).add(),bv.plotBorderWidth&&cq.rect(bL,bC,ce,ca,0,bv.plotBorderWidth).attr({stroke:bv.plotBorderColor,"stroke-width":bv.plotBorderWidth,zIndex:4}).add(),cl&&br(cm,function(a){a.render()}),$(),c.items&&br(c.items,function(){var b=a(c.style,this.style),d=parseInt(b.left,10)+bL,e=parseInt(b.top,10)+bC+12;delete b.left,delete b.top,cq.text(this.html,d,e,b).attr({zIndex:2}).add()}),br(co,function(a){a.render()}),cj=bU.legend=new cv(bU),bU.toolbar||(bU.toolbar=k(bU)),d.enabled&&!bU.credits&&cq.text(d.text,bS-10,bT-5,d.style,0,"right").on("click",function(){location.href=d.href}).attr({zIndex:8}).add(),bU.hasRendered=!0,bO&&(bN.appendChild(bQ),l(bO))}function _(){bN=bv.renderTo,bR=U+K++,typeof bN=="string"&&(bN=s.getElementById(bN)),bN.innerHTML="",bN.offsetWidth||(bO=bN.cloneNode(0),g(bO,{position:R,top:"-9999px",display:""}),s.body.appendChild(bO));var b=(bO||bN).offsetHeight;bU.chartWidth=bS=bv.width||(bO||bN).offsetWidth||600,bU.chartHeight=bT=bv.height||(b>bC+bE?b:0)||400,bU.plotWidth=ce=bS-bL-bD,bU.plotHeight=ca=bT-bC-bE,bU.plotLeft=bL,bU.plotTop=bC,bU.container=bQ=h(Q,{className:"highcharts-container"+(bv.className?" "+bv.className:""),id:bR},a({position:S,overflow:T,width:bS+W,height:bT+W,textAlign:"left"},bv.style),bO||bN),bU.renderer=cq=bv.renderer=="SVG"?new bM(bQ,bS,bT):new bP(bQ,bS,bT)}function $(){var a=f.title,b=a.align,c=f.subtitle,d=c.align,e={left:0,center:bS/2,right:bS};a&&a.text&&cq.text(a.text,e[b]+a.x,a.y,a.style,0,b).attr({"class":"highcharts-title"}).add(),c&&c.text&&cq.text(c.text,e[d]+c.x,c.y,c.style,0,d).attr({"class":"highcharts-subtitle"}).add()}function V(){return bs(co,function(a){return a.selected})}function M(){var a=[];br(co,function(b){a=a.concat(bs(b.data,function(a){return a.selected}))});return a}function J(){var a=f.xAxis||{},b=f.yAxis||{},c;a=d(a),br(a,function(a,b){a.index=b,a.isX=!0}),b=d(b),br(b,function(a,b){a.index=b}),cm=a.concat(b),bU.xAxis=[],bU.yAxis=[],cm=bt(cm,function(a){c=new j(bU,a),bU[c.isXAxis?"xAxis":"yAxis"].push(c);return c}),r()}function F(a){var b,c,d;for(b=0;b<cm.length;b++)if(cm[b].options.id==a)return cm[b];for(b=0;b<co.length;b++)if(co[b].options.id==a)return co[b];for(b=0;b<co.length;b++){d=co[b].data;for(c=0;c<d.length;c++)if(d[c].id==a)return d[c]}return null}function D(){bz(b$,{opacity:0},{duration:f.loading.hideDuration,complete:function(){g(b$,{display:X})}}),b_=!1}function C(b){var c=f.loading;b$||(b$=h(Q,{className:"highcharts-loading"},a(c.style,{left:bL+W,top:bC+W,width:ce+W,height:ca+W,zIndex:10,display:X}),bQ),h("span",null,c.labelStyle,b$)),b_||(g(b$,{opacity:0,display:""}),b$.getElementsByTagName("span")[0].innerHTML=b||f.lang.loading,bz(b$,{opacity:c.style.opacity},{duration:c.showDuration}),b_=!0)}function B(){for(var a=bU.isDirty,b,c=co.length,d=c,e;d--;){e=co[d];if(e.isDirty&&e.options.stacking){b=!0;break}}if(b)for(d=c;d--;)e=co[d],e.options.stacking&&(e.isDirty=!0);br(co,function(b){b.isDirty&&(b.cleanData(),b.getSegments(),b.options.legendType=="point"&&(a=!0))}),cn=null,cl&&(br(cm,function(a){a.setScale()}),r(),br(cm,function(a){a.isDirty&&a.redraw()})),br(co,function(a){a.isDirty&&a.visible&&a.redraw()}),a&&cj.renderLegend&&(cj.renderLegend(),bU.isDirty=!1),ch&&ch.resetTracker&&ch.resetTracker(),by(bU,"redraw")}function r(){bv.alignTicks!==!1&&br(cm,function(a){a.adjustTickAmount()})}function q(a,b){var c;b=e(b,!0),by(bU,"addSeries",{options:a},function(){c=p(a),c.isDirty=!0,bU.isDirty=!0,b&&bU.redraw()});return c}function p(a){var b=a.type||bv.defaultSeriesType,c=bB[b],d=bU.hasRendered;d&&(cp&&b=="column"?c=bB.bar:!cp&&b=="bar"&&(c=bB.column)),b=new c,b.init(bU,a),!d&&b.inverted&&(cp=!0),b.isCartesian&&(cl=b.isCartesian),co.push(b);return b}function n(b,d){function k(){b.trackerGroup=ci=cq.g("tracker"),cp&&ci.attr({width:b.plotWidth,height:b.plotHeight}).invert(),ci.attr({zIndex:9}).translate(bL,bC).add()}function j(){var d=!0;bQ.onmousedown=function(a){a=e(a),a.preventDefault&&a.preventDefault(),b.mouseIsDown=bZ=!0,l=a.chartX,n=a.chartY,cl&&(s||u)&&(q||(q=cq.rect(bL,bC,v?1:ce,w?1:ca,0).attr({fill:"rgba(69,114,167,0.25)",zIndex:7}).add()))},bQ.onmousemove=function(a){a=e(a),a.returnValue=!1;var b=a.chartX,c=a.chartY,f=!bX(b-bL,c-bC);bZ?(p=Math.sqrt(Math.pow(l-b,2)+Math.pow(n-c,2))>10,v&&(a=b-l,q.attr({width:A(a),x:(a>0?0:a)+l})),w&&(c=c-n,q.attr({height:A(c),y:(c>0?0:c)+n}))):f||g(a),f&&!d&&(h(),i()),d=f;return!1},bQ.onmouseup=function(){i()},bQ.onclick=function(d){var g=b.hoverPoint;d=e(d),d.cancelBubble=!0;if(!p)if(g&&c(d.target,"isTracker")){var h=g.plotX,i=g.plotY;a(g,{pageX:ck.x+bL+(cp?ce-i:h),pageY:ck.y+bC+(cp?ca-h:i)}),by(b.hoverSeries||g.series,"click",a(d,{point:g})),g.firePointEvent("click",d)}else a(d,f(d)),bX(d.chartX-bL,d.chartY-bC)&&by(b,"click",d);p=!1}}function i(){if(q){var a={xAxis:[],yAxis:[]},c=q.getBBox(),d=c.x-bL,e=c.y-bC;p&&(br(cm,function(b){var f=b.translate,g=b.isXAxis,h=cp?!g:g,i=f(h?d:ca-e-c.height,!0);f=f(h?d+c.width:ca-e,!0),a[g?"xAxis":"yAxis"].push({axis:b,min:z(i,f),max:y(i,f)})}),by(b,"selection",a,ct)),q=q.destroy()}b.mouseIsDown=bZ=p=!1}function h(){var a=b.hoverSeries,c=b.hoverPoint;c&&c.onMouseOut(),a&&a.onMouseOut(),bY&&bY.hide()}function g(a){var c=b.hoverPoint,d=b.hoverSeries;d&&d.tracker&&((a=d.tooltipPoints[cp?a.chartY:a.chartX-bL])&&a!=c&&a.onMouseOver())}function f(a){var b={xAxis:[],yAxis:[]};br(cm,function(c){var d=c.translate,e=c.isXAxis,f=cp?!e:e;b[e?"xAxis":"yAxis"].push({axis:c,value:d(f?a.chartX-bL:ca-a.chartY+bC,!0)})});return b}function e(a){a=a||t.event,a.target||(a.target=a.srcElement);if(a.type!="mousemove"||t.opera)ck=o(bQ);E?(a.chartX=a.x,a.chartY=a.y):a.layerX===P?(a.chartX=a.pageX-ck.x,a.chartY=a.pageY-ck.y):(a.chartX=a.layerX,a.chartY=a.layerY);return a}var l,n,p,q,r=bv.zoomType,s=/x/.test(r),u=/y/.test(r),v=s&&!cp||u&&cp,w=u&&!cp||s&&cp;k(),d.enabled&&(b.tooltip=bY=m(d)),j(),cs=setInterval(function(){cr&&cr()},32),a(this,{zoomX:s,zoomY:u,resetTracker:h})}function m(a){function d(d){var f=d.series,g=a.borderColor||d.color||f.color||"#606060",m,n;n=d.tooltipText,m=d.tooltipPos,e=f,f=v(m?m[0]:cp?ce-d.plotY:d.plotX),d=v(m?m[1]:cp?ca-d.plotX:d.plotY),m=bX(f,d),n!==!1&&m?(j&&(o.show(),j=!1),q.attr({text:n}),n=q.getBBox(),k=n.width,l=n.height,p.attr({width:k+2*h,height:l+2*h,stroke:g}),g=f-k+bL-25,f=d-l+bC+10,g<7&&(g=7,f-=20),f<5?f=5:f+l>bT&&(f=bT-l-5),b(v(g-i),v(f-i))):c()}function c(){j=!0,o.hide()}function b(a,c){m=j?a:(2*m+a)/3,n=j?c:(n+c)/2,o.translate(m,n),cr=A(a-m)>1||A(c-n)>1?function(){b(a,c)}:null}var e,f=a.borderWidth,g=a.style,h=parseInt(g.padding,10),i=f+h,j=!0,k,l,m=0,n=0;g.padding=0;var o=cq.g("tooltip").attr({zIndex:8}).add(),p=cq.rect(i,i,0,0,a.borderRadius,f).attr({fill:a.backgroundColor,"stroke-width":f}).add(o).shadow(a.shadow),q=cq.text("",h+i,parseInt(g.fontSize,10)+h+i).attr({zIndex:1}).css(g).add(o);return{refresh:d,hide:c}}function k(){function b(a){l(c[a].element),c[a]=null}function a(a,b,d,e){c[a]||(b=cq.text(b,bL+ce-20,bC+30,f.toolbar.itemStyle,0,"right").on("click",e).attr({zIndex:20}).add(),c[a]=b)}var c={};return{add:a,remove:b}}function j(c,d){function F(a,b){K.categories=bY=a,br(_,function(a){a.translate(),a.setTooltipPoints(!0)}),K.isDirty=!0,e(b,!0)&&D()}function D(){ch.resetTracker&&ch.resetTracker(),B(),br(_,function(a){a.isDirty=!0})}function C(a){br([bN,bO],function(b){for(var c=0;c<b.length;c++)if(b[c].id==a){b.splice(c,1);break}}),B()}function B(){var a=d.title,c=d.alternateGridColor,e=d.minorTickWidth,f=d.lineWidth,g,k;g=_.length&&b(bp)&&b(bc),V?(V.empty(),W.empty()):(V=cq.g("axis").attr({zIndex:7}).add(),W=cq.g("grid").attr({zIndex:1}).add());if(g||bt){c&&br(bU,function(a,b){b%2===0&&a<bc&&i(a,bU[b+1]!==P?bU[b+1]:bc,c)}),br(bN,function(a){i(a.from,a.to,a.color)});if(bQ&&!bY)for(g=bp;g<=bc;g+=bQ)h(g,d.minorGridLineColor,d.minorGridLineWidth),e&&j(g,d.minorTickPosition,d.minorTickColor,e,d.minorTickLength);br(bU,function(a,b){k=a+b$,h(k,d.gridLineColor,d.gridLineWidth),j(a,d.tickPosition,d.tickColor,d.tickWidth,d.tickLength,(a!=bp||d.showFirstLabel)&&(a!=bc||d.showLastLabel),b)}),br(bO,function(a){h(a.value,a.color,a.width)})}!K.hasRenderedLine&&f&&(e=bL+(H?ce:0)+Q,g=bT-bE-(H?ca:0)+Q,cq.path(cq.crispLine([Y,I?bL:e,I?g:bC,Z,I?bS-bD:e,I?g:bT-bE],f)).attr({stroke:d.lineColor,"stroke-width":f,zIndex:7}).add(),K.hasRenderedLine=!0),!K.hasRenderedTitle&&!K.axisTitle&&a&&a.text&&(f=I?bL:bC,f=({low:f+(I?0:S),middle:f+S/2,high:f+(I?S:0)})[a.align],e=(I?bC+ca:bL)+(I?1:-1)*(H?-1:1)*a.margin-(E?parseInt(a.style.fontSize||12,10)/3:0),K.axisTitle=cq.text(a.text,(I?f:e+(H?ce:0)+Q)+(a.x||0),(I?e-(H?ca:0)+Q:f)+(a.y||0),a.style,a.rotation||0,({low:"left",middle:"center",high:"right"})[a.align]).attr({zIndex:7}).add(),K.hasRenderedTitle=!0),K.isDirty=!1}function A(a){var b=a.width,c=b?bO:bN;c.push(a),b?h(a.value,a.color,a.width):i(a.from,a.to,a.color)}function t(a){bp>a?a=bp:bc<a&&(a=bc);return g(a,0,1)}function s(){return{min:bp,max:bc,dataMin:X,dataMax:$}}function r(a,b,d){d=e(d,!0),by(K,"setExtremes",{min:a,max:b},function(){bY&&(a<0&&(a=0),b>bY.length-1&&(b=bY.length-1)),ba=a,bb=b,d&&c.redraw()})}function q(){var a,g,h,i=bp,j=bc;a=d.maxZoom;var l;f(),bp=e(ba,d.min,X),bc=e(bb,d.max,$),bt&&(l=c[G?"xAxis":"yAxis"][d.linkedTo],l=l.getExtremes(),bp=e(l.min,l.dataMin),bc=e(l.max,l.dataMax)),bc-bp<a&&(l=(a-bc+bp)/2,bp=y(bp-l,e(d.min,bp-l)),bc=z(bp+a,e(d.max,bp+a))),!bY&&!bA&&!bt&&b(bp)&&b(bc)&&(a=bc-bp||1,!b(d.min)&&!b(ba)&&bq&&(X<0||!bx)&&(bp-=a*bq),!b(d.max)&&!b(bb)&&bs&&($>0||!bz)&&(bc+=a*bs)),bP=bY||bp==bc?1:e(d.tickInterval,(bc-bp)*d.tickPixelInterval/S),!M&&!b(d.tickInterval)&&(bP=k(bP)),bQ=d.minorTickInterval==="auto"&&bP?bP/5:d.minorTickInterval,o(),T=S/(bc-bp||1),cn||(cn={x:0,y:0}),!M&&bU.length>cn[R]&&(cn[R]=bU.length);if(!G)for(g in J)for(h in J[g])J[g][h].cum=J[g][h].total;K.isDirty||(K.isDirty=bp!=i||bc!=j)}function p(){if(!M&&!bY){var a=bV,c=bU.length;bV=cn[R];if(c<bV){for(;bU.length<bV;)bU.push(m(bU[bU.length-1]+bP));T*=(c-1)/(bV-1)}b(a)&&bV!=a&&(K.isDirty=!0)}}function o(){M?l():n();var a=bU[0],b=bU[bU.length-1];d.startOnTick?bp=a:bp>a&&bU.shift(),d.endOnTick?bc=b:bc<b&&bU.pop()}function n(){var a;a=w(bp/bP)*bP;var b=x(bc/bP)*bP;bU=[];for(a=m(a);a<=b;)bU.push(a),a=m(a+bP);bY&&(bp-=.5,bc+=.5)}function m(a){var b=(bR<1?v(1/bR):1)*10;return v(a*b)/b}function l(){bU=[];var a,b=N.global.useUTC,c=1e3/L,e=6e4/L,f=36e5/L,g=864e5/L,h=6048e5/L,i=2592e6/L,j=31556952e3/L,l=[["second",c,[1,2,5,10,15,30]],["minute",e,[1,2,5,10,15,30]],["hour",f,[1,2,3,4,6,8,12]],["day",g,[1,2]],["week",h,[1,2]],["month",i,[1,2,3,4,6]],["year",j,null]],m=l[6],n=m[1],o=m[2];for(a=0;a<l.length;a++){m=l[a],n=m[1],o=m[2];if(l[a+1]){var p=(n*o[o.length-1]+l[a+1][1])/2;if(bP<=p)break}}n==j&&bP<5*n&&(o=[1,2,5]),l=k(bP/n,o);var q;o=new Date(bp*L),o.setMilliseconds(0),n>=c&&o.setSeconds(n>=e?0:l*w(o.getSeconds()/l)),n>=e&&o[bk](n>=f?0:l*w(o[be]()/l)),n>=f&&o[bl](n>=g?0:l*w(o[bf]()/l)),n>=g&&o[bm](n>=i?1:l*w(o[bh]()/l)),n>=i&&(o[bn](n>=j?0:l*w(o[bi]()/l)),q=o[bj]()),n>=j&&(q-=q%l,o[bo](q)),n==h&&o[bm](o[bh]()-o[bg]()+d.startOfWeek),a=1,q=o[bj](),c=o.getTime()/L,e=o[bi]();for(f=o[bh]();c<bc&&a<ce;)bU.push(c),n==j?c=bd(q+a*l,0)/L:n==i?c=bd(q,e+a*l)/L:b||n!=g&&n!=h?c+=n*l:c=bd(q,e,f+a*l*(n==g?1:7)),a++;bU.push(c),bW=d.dateTimeLabelFormats[m[0]]}function k(a,b){var c;bR=b?1:u.pow(10,w(u.log(a)/u.LN10)),c=a/bR,b||(b=[1,2,2.5,5,10],d.allowDecimals===!1&&(bR==1?b=[1,2,5,10]:bR<=.1&&(b=[1/bR])));for(var e=0;e<b.length;e++){a=b[e];if(c<=(b[e]+(b[e+1]||b[e]))/2)break}a*=bR;return a}function j(a,b,c,e,f,h,i){var j,k,l,m=d.labels;b=="inside"&&(f=-f),H&&(f=-f),b=k=g(a+b$)+U,j=l=bT-g(a+b$)-U,I?(j=bT-bE-(H?ca:0)+Q,l=j+f):(b=bL+(H?ce:0)+Q,k=b-f),e&&cq.path(cq.crispLine([Y,b,j,Z,k,l],e)).attr({stroke:c,"stroke-width":e}).add(V);if(h&&m.enabled)if((a=bX.call({index:i,isFirst:a==bU[0],isLast:a==bU[bU.length-1],dateTimeLabelFormat:bW,value:bY&&bY[a]?bY[a]:a}))||a===0)b=b+m.x-(b$&&I?b$*T*(bZ?-1:1):0),j=j+m.y-(b$&&!I?b$*T*(bZ?1:-1):0),cq.text(a,b,j,m.style,m.rotation,m.align).add(V)}function i(a,b,c){a=y(a,bp),b=z(b,bc);var d=(b-a)*T;h(a+(b-a)/2,c,d)}function h(a,b,c){if(c){var d,e,f;d=g(a);var h;a=e=d+U,d=f=bT-d-U;if(I){d=bC,f=bT-bE;if(a<bL||a>bL+ce)h=!0}else{a=bL,e=bS-bD;if(d<bC||d>bC+ca)h=!0}h||cq.path(cq.crispLine([Y,a,d,Z,e,f],c)).attr({stroke:b,"stroke-width":c}).add(W)}}function g(a,b,c){var d=1,e=0;c&&(d*=-1,e=S),bZ&&(d*=-1,e-=d*S),bp===P?a=null:b?(bZ&&(a=S-a),a=a/T+bp):a=d*(a-bp)*T+e;return a}function f(){var a=[],c;X=$=null,_=[],br(co,function(e){c=!1,br(["xAxis","yAxis"],function(a){e.isCartesian&&(a=="xAxis"&&G||a=="yAxis"&&!G)&&(e.options[a]==d.index||e.options[a]===P&&d.index===0)&&(e[a]=K,_.push(e),c=!0)}),!e.visible&&bv.ignoreHiddenSeries&&(c=!1);if(c){var f,g;G||(f=e.options.stacking,bA=f=="percent",f&&(g=a[e.type]||[],a[e.type]=g),bA&&(X=0,$=99)),e.isCartesian&&(br(e.data,function(a){var c=a.x,d=a.y;X===null&&(X=$=a[R]),G?c>$?$=c:c<X&&(X=c):b(d)&&(f&&(g[c]=g[c]?g[c]+d:d),a=g?g[c]:d,bA||(a>$?$=a:a<X&&(X=a)),f&&(J[e.type][c]={total:a,cum:a}))}),/(area|column|bar)/.test(e.type)&&!G&&(X<0?$<0&&($=0,bz=!0):(X=0,bx=!0)))}})}var G=d.isX,H=d.opposite,I=cp?!G:G,J={bar:{},column:{},area:{},areaspline:{},line:{}};d=bu(G?bF:bG,I?H?bK:bJ:H?bI:bH,d);var K=this,M=d.type=="datetime",Q=d.offset||0,R=G?"x":"y",S=I?ce:ca,T,U=I?bL:bE,V,W,X,$,_,ba,bb,bc=null,bp=null,bq=d.minPadding,bs=d.maxPadding,bt=b(d.linkedTo),bx,bz,bA,bB=d.events,bM,bN=d.plotBands||[],bO=d.plotLines||[],bP,bQ,bR,bU,bV,bW,bX=d.labels.formatter||function(){var a=this.value;return bW?O(bW,a):a},bY=d.categories||G&&c.columnCount,bZ=d.reversed,b$=bY&&d.tickmarkPlacement=="between"?.5:0;cp&&G&&bZ===P&&(bZ=!0),H||(Q*=-1),I&&(Q*=-1),a(K,{addPlotBand:A,addPlotLine:A,adjustTickAmount:p,categories:bY,getExtremes:s,getThreshold:t,isXAxis:G,options:d,render:B,setExtremes:r,setScale:q,setCategories:F,translate:g,redraw:D,removePlotBand:C,removePlotLine:C,reversed:bZ,stacks:J});for(bM in bB)bw(K,bM,bB[bM]);q()}bF=bu(bF,N.xAxis),bG=bu(bG,N.yAxis),N.xAxis=N.yAxis=null,f=bu(N,f);var bv=f.chart,bA=bv.margin;bA=typeof bA=="number"?[bA,bA,bA,bA]:bA;var bC=e(bv.marginTop,bA[0]),bD=e(bv.marginRight,bA[1]),bE=e(bv.marginBottom,bA[2]),bL=e(bv.marginLeft,bA[3]),bN,bO,bQ,bR,bS,bT,bU=this;bA=bv.events;var bV,bW,bX,bY,bZ,b$,b_,ca,ce,cf,cg,ch,ci,cj,ck,cl=bv.showAxes,cm=[],cn,co=[],cp,cq,cr,cs,ct,cu,cv=function(b){function i(){z=x,A=w,B=G=0,F||(F=cq.g("legend").attr({zIndex:7}).add()),L&&K.reverse(),br(K,function(a){a.options.showInLegend&&(a=a.options.legendType=="point"?a.data:[a],br(a,f))}),L&&K.reverse(),I=H||G,J=B-w+v;if(D||E)I+=2*t,J+=2*t,C?C.attr({height:J,width:I}):C=cq.rect(0,0,I,J,j.borderRadius,D||0).attr({stroke:j.borderColor,"stroke-width":D||0,fill:E||X}).add(F).shadow(j.shadow);for(var b=["left","right","top","bottom"],c,d=4;d--;)c=b[d],p[c]&&p[c]!="auto"&&(j[d<2?"align":"verticalAlign"]=c,j[d<2?"x":"y"]=parseInt(p[c],10)*(d%2?-1:1));var e=bW(a({width:I,height:J},j));F.translate(e.x,e.y),br(o,function(a){var b=a.checkbox;b&&g(b,{left:e.x+a.legendItemWidth+b.x-40+W,top:e.y+b.y-11+W})})}function f(a){var b,e,f=a.legendItem;e=a.series||a,f||(e=/^(bar|pie|area|column)$/.test(e.type),a.legendItem=f=cq.text(j.labelFormatter.call(a),0,0).css(a.visible?q:s).on("mouseover",function(){a.setState(bb),f.css(r)}).on("mouseout",function(){f.css(a.visible?q:s),a.setState()}).on("click",function(){var b="legendItemClick",c=function(){a.setVisible()};a.firePointEvent?a.firePointEvent(b,null,c):by(a,b,null,c)}).attr({zIndex:2}).add(F),!e&&a.options&&a.options.lineWidth&&(a.legendLine=cq.path([Y,-m-n,0,Z,-n,0]).attr({"stroke-width":a.options.lineWidth,zIndex:2}).add(F)),e?b=cq.rect(-m-n,-11,m,12,2).attr({"stroke-width":0,zIndex:3}).add(F):a.options&&a.options.marker&&a.options.marker.enabled&&(b=cq.symbol(a.symbol,-m/2-n,-4,a.options.marker.radius).attr(a.pointAttr[ba]).attr({zIndex:3}).add(F)),a.legendSymbol=b,c(a,a.visible),a.options&&a.options.showCheckbox&&(a.checkbox=h("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},j.itemCheckboxStyle,bQ),bw(a.checkbox,"click",function(b){b=b.target,by(a,"checkboxClick",{checked:b.checked},function(){a.select()})}))),d(a,z,A),b=f.getBBox(),B=A,a.legendItemWidth=b=j.itemWidth||m+n+b.width+u,k?(z+=b,G=H||y(z-x,G),z-x+b>(H||bS-2*t-x)&&(z=x,A+=v)):(A+=v,G=H||y(b,G)),o.push(a)}function e(a){for(var b=o.length,c=a.checkbox;b--;)if(o[b]==a){o.splice(b,1);break}br(["legendItem","legendLine","legendSymbol"],function(b){a[b]&&a[b].destroy()}),c&&l(a.checkbox)}function d(a,b,c){var d=a.legendItem,e=a.legendLine,f=a.legendSymbol;a=a.checkbox,d&&d.attr({x:b,y:c}),e&&e.translate(b,c-4),f&&f.translate(b,c),a&&(a.x=b,a.y=c)}function c(a,b){var c=a.legendItem,d=a.legendLine,e=a.legendSymbol,f=s.color,g=b?j.itemStyle.color:f;a=b?a.color:f,c&&c.css({color:g}),d&&d.attr({stroke:a}),e&&e.attr({stroke:a,fill:a})}var j=b.options.legend;if(j.enabled){var k=j.layout=="horizontal",m=j.symbolWidth,n=j.symbolPadding,o=[],p=j.style,q=j.itemStyle,r=j.itemHoverStyle,s=j.itemHiddenStyle,t=parseInt(p.padding,10),u=20,v=j.lineHeight||16,w=18,x=4+t+m+n,z,A,B,C,D=j.borderWidth,E=j.backgroundColor,F,G,H=j.width,I,J,K=b.series,L=j.reversed;i();return{colorizeItem:c,destroyItem:e,renderLegend:i}}};bX=function(a,b){var c=0,d=0;return a>=c&&a<=c+ce&&b>=d&&b<=d+ca},cu=function(){by(bU,"selection",{resetSelection:!0},ct),bU.toolbar.remove("zoom")},ct=function(a){var b=N.lang;bU.toolbar.add("zoom",b.resetZoom,b.resetZoomTitle,cu),!a||a.resetSelection?br(cm,function(a){a.setExtremes(null,null,!1)}):br(a.xAxis.concat(a.yAxis),function(a){var b=a.axis;bU.tracker[b.isXAxis?"zoomX":"zoomY"]&&b.setExtremes(a.min,a.max,!1)}),B()},bW=function(a){var b=a.align,c=a.verticalAlign,d=a.x||0,e=a.y||0,f={x:d||0,y:e||0};/^(right|center)$/.test(b)&&(f.x=(bS-a.width)/({right:1,center:2})[b]+d),/^(bottom|middle)$/.test(c)&&(f.y=(bT-a.height)/({bottom:1,middle:2})[c]+e);return f},I=H=0,bw(t,"unload",bp);if(bA)for(bV in bA)bw(bU,bV,bA[bV]);bU.options=f,bU.series=co,bU.addSeries=q,bU.destroy=bp,bU.get=F,bU.getAlignment=bW,bU.getSelectedPoints=M,bU.getSelectedSeries=V,bU.hideLoading=D,bU.isInsidePlot=bX,bU.redraw=B,bU.showLoading=C,bq()}function p(){}function o(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a.offsetParent;)a=a.offsetParent,b.x+=a.offsetLeft,b.y+=a.offsetTop,a!=s.body&&a!=s.documentElement&&(b.x-=a.scrollLeft,b.y-=a.scrollTop);return b}function n(a,b,c,d){var e=N.lang;a=a;var f=isNaN(b=A(b))?2:b;b=c===undefined?e.decimalPoint:c,d=d===undefined?e.thousandsSep:d,e=a<0?"-":"",c=parseInt(a=A(+a||0).toFixed(f),10)+"";var g=(g=c.length)>3?g%3:0;return e+(g?c.substr(0,g)+d:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(f?b+A(a-c).toFixed(f).slice(2):"")}function m(b,c){var d=function(){};d.prototype=new b,a(d.prototype,c);return d}function l(a){M||(M=h(Q)),a&&M.appendChild(a),M.innerHTML=""}function k(){return N}function j(a){N=bu(N,a),i();return N}function i(){var a=N.global.useUTC;bd=a?Date.UTC:function(a,b,c,d,f,g){return(new Date(a,b,e(c,1),e(d,0),e(f,0),e(g,0))).getTime()},be=a?"getUTCMinutes":"getMinutes",bf=a?"getUTCHours":"getHours",bg=a?"getUTCDay":"getDay",bh=a?"getUTCDate":"getDate",bi=a?"getUTCMonth":"getMonth",bj=a?"getUTCFullYear":"getFullYear",bk=a?"setUTCMinutes":"setMinutes",bl=a?"setUTCHours":"setHours",bm=a?"setUTCDate":"setDate",bn=a?"setUTCMonth":"setMonth",bo=a?"setUTCFullYear":"setFullYear"}function h(b,c,d,e,f){b=s.createElement(b),c&&a(b,c),f&&g(b,{padding:0,border:X,margin:0}),d&&g(b,d),e&&e.appendChild(b);return b}function g(b,c){E&&(c&&c.opacity!==P&&(c.filter="alpha(opacity="+c.opacity*100+")")),a(b.style,c)}function f(a){var b="",c;for(c in a)b+=bv(c)+":"+a[c]+";";return b}function e(){var a=arguments,c,d;for(c=0;c<a.length;c++){d=a[c];if(b(d))return d}}function d(a){if(!a||a.constructor!=Array)a=[a];return a}function c(a,c,d){var e,f="setAttribute",g;if(typeof c=="string")b(d)?a[f](c,d):a&&a.getAttribute&&(g=a.getAttribute(c));else if(b(c)&&typeof c=="object")for(e in c)a[f](e,c[e]);return g}function b(a){return a!==P&&a!==null}function a(a,b){a||(a={});for(var c in b)a[c]=b[c];return a}var s=document,t=window,u=Math,v=u.round,w=u.floor,x=u.ceil,y=u.max,z=u.min,A=u.abs,B=u.cos,C=u.sin,D=navigator.userAgent,E=/msie/i.test(D)&&!t.opera,F=/AppleWebKit/.test(D),G=t.SVGAngle||s.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),H,I,J={},K=0,L=1,M,N,O,P,Q="div",R="absolute",S="relative",T="hidden",U="highcharts-",V="visible",W="px",X="none",Y="M",Z="L",_="rgba(192,192,192,"+(G?1e-6:.002)+")",ba="",bb="hover",bc="select",bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp=t.HighchartsAdapter,bq=bp||{},br=bq.each,bs=bq.grep,bt=bq.map,bu=bq.merge,bv=bq.hyphenate,bw=bq.addEvent,bx=bq.removeEvent,by=bq.fireEvent,bz=bq.animate,bA=bq.stop;bq=bq.getAjax;var bB={};if(!bp&&t.jQuery){var bC=jQuery;br=function(a,b){for(var c=0,d=a.length;c<d;c++)if(b.call(a[c],a[c],c,a)===!1)return c},bs=bC.grep,bt=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=b.call(a[d],a[d],d,a);return c},bu=function(){var a=arguments;return bC.extend(!0,null,a[0],a[1],a[2],a[3])},bv=function(a){return a.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()})},bw=function(a,b,c){bC(a).bind(b,c)},bx=function(a,b,c){var d=s.removeEventListener?"removeEventListener":"detachEvent";s[d]&&!a[d]&&(a[d]=function(){}),bC(a).unbind(b,c)},by=function(b,c,d,e){var f=bC.Event(c),g="detached"+c;a(f,d),b[c]&&(b[g]=b[c],b[c]=null),bC(b).trigger(f),b[g]&&(b[c]=b[g],b[g]=null),e&&!f.isDefaultPrevented()&&e(f)},bz=function(a,b,c){a=bC(a),a.stop(),a.animate(b,c)},bA=function(a){bC(a).stop()},bq=function(a,b){bC.get(a,null,b)},bC.extend(bC.easing,{easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c}});var bD=jQuery.fx.step._default,bE=jQuery.fx.prototype.cur;bC.fx.step._default=function(a){var b=a.elem;b.attr?b.attr(a.prop,a.now):bD.apply(this,arguments)},bC.fx.prototype.cur=function(){var a=this.elem;return a=a.attr?a.attr(this.prop):bE.apply(this,arguments)}}else!bp&&t.MooTools&&(br=$each,bt=function(a,b){return a.map(b)},bs=function(a,b){return a.filter(b)},bu=$merge,bv=function(a){return a.hyphenate()},bw=function(b,c,d){typeof c=="string"&&(c=="unload"&&(c="beforeunload"),b.addEvent||(b.nodeName?b=$(b):a(b,new Events)),b.addEvent(c,d))},bx=function(a,b,c){b&&(b=="unload"&&(b="beforeunload"),a.removeEvent(b,c))},by=function(b,c,d,e){c=new Event({type:c,target:b}),c=a(c,d),c.preventDefault=function(){e=null},b.fireEvent&&b.fireEvent(c.type,c),e&&e(c)},bz=function(b,c,d){var e=b.attr;e&&!b.setStyle&&(b.setStyle=b.getStyle=b.attr,b.$family=b.uid=!0),bA(b),d=new Fx.Morph(e?b:$(b),a(d,{transition:Fx.Transitions.Quad.easeInOut})),d.start(c),b.fx=d},bA=function(a){a.fx&&a.fx.cancel()},bq=function(a,b){(new Request({url:a,method:"get",onSuccess:b})).send()});bp={enabled:!0,align:"center",x:0,y:15,style:{color:"#666",fontSize:"11px"}},N={colors:["#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0},chart:{margin:[50,50,90,80],borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0"},title:{text:"Chart title",x:0,y:20,align:"center",style:{color:"#3E576F",fontSize:"16px"}},subtitle:{text:"",x:0,y:40,align:"center",style:{color:"#6D869F"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:!0,events:{},lineWidth:2,shadow:!0,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:bu(bp,{enabled:!1,y:-6,formatter:function(){return this.y}}),showInLegend:!0,states:{hover:{lineWidth:3,marker:{}},select:{marker:{}}},stickyTracking:!0}},labels:{style:{position:R,color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,shadow:!1,style:{padding:"5px"},itemStyle:{cursor:"pointer",color:"#3E576F"},itemHoverStyle:{cursor:"pointer",color:"#000000"},itemHiddenStyle:{color:"#C0C0C0"},itemCheckboxStyle:{position:R,width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:15,y:-15},loading:{hideDuration:100,labelStyle:{fontWeight:"bold",position:S,top:"1em"},showDuration:100,style:{position:R,backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,formatter:function(){var a=this,c=a.series,d=c.xAxis,e=a.x;return"<b>"+(a.point.name||c.name)+"</b><br/>"+(b(e)?"X value: "+(d&&d.options.type=="datetime"?O(null,e):e)+"<br/>":"")+"Y value: "+a.y},backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:2,borderRadius:5,shadow:!0,snap:10,style:{color:"#333333",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}},toolbar:{itemStyle:{color:"#4572A7",cursor:"pointer"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",style:{cursor:"pointer",color:"#909090",fontSize:"10px"}}};var bF={dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:bp,lineColor:"#C0D0E0",lineWidth:1,max:null,min:null,minPadding:.01,maxPadding:.01,maxZoom:null,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",minorTickWidth:1,showFirstLabel:!0,showLastLabel:!1,startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",margin:35,style:{color:"#6D869F",fontWeight:"bold"}},type:"linear"},bG=bu(bF,{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{align:"right",x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{margin:40,rotation:270,text:"Y-values"}}),bH={labels:{align:"right",x:-8,y:3},title:{rotation:270}},bI={labels:{align:"left",x:8,y:3},title:{rotation:90}},bJ={labels:{align:"center",x:0,y:14},title:{rotation:0}},bK=bu(bJ,{labels:{y:-5}});bp=N.plotOptions,bq=bp.line,bp.spline=bu(bq),bp.scatter=bu(bq,{lineWidth:0,states:{hover:{lineWidth:0}}}),bp.area=bu(bq,{}),bp.areaspline=bu(bp.area),bp.column=bu(bq,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,states:{hover:{brightness:.1,shadow:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}}),bp.bar=bu(bp.column,{dataLabels:{align:"left",x:5,y:0}}),bp.pie=bu(bq,{borderColor:"#FFFFFF",borderWidth:1,center:["50%","50%"],colorByPoint:!0,legendType:"point",marker:null,size:"90%",slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}}}),i();var bL=function(a){function e(a){f[3]=a;return this}function d(a){if(typeof a=="number"&&a!==0)for(var b=0;b<3;b++)f[b]+=parseInt(a*255,10),f[b]<0&&(f[b]=0),f[b]>255&&(f[b]=255);return this}function c(b){return b=f&&!isNaN(f[0])?b=="rgb"?"rgb("+f[0]+","+f[1]+","+f[2]+")":b=="a"?f[3]:"rgba("+f.join(",")+")":a}function b(a){if(g=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(a))f=[parseInt(g[1],10),parseInt(g[2],10),parseInt(g[3],10),parseFloat(g[4],10)];else if(g=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))f=[parseInt(g[1],16),parseInt(g[2],16),parseInt(g[3],16),1]}var f=[],g;b(a);return{get:c,brighten:d,setOpacity:e}};O=function(a,c,d){function f(a){return a.toString().replace(/^([0-9])$/,"0$1")}if(!b(c)||isNaN(c))return"Invalid date";a=e(a,"%Y-%m-%d %H:%M:%S"),c=new Date(c*L);var g=c[bf](),h=c[bg](),i=c[bh](),j=c[bi](),k=c[bj](),l=N.lang,m=l.weekdays;l=l.months,c={a:m[h].substr(0,3),A:m[h],d:f(i),e:i,b:l[j].substr(0,3),B:l[j],m:f(j+1),y:k.toString().substr(2,2),Y:k,H:f(g),I:f(g%12||12),l:g%12||12,M:f(c[be]()),p:g<12?"AM":"PM",P:g<12?"am":"pm",S:f(c.getSeconds())};for(var n in c)a=a.replace("%"+n,c[n]);return d?a.substr(0,1).toUpperCase()+a.substr(1):a},p.prototype={init:function(a,b){this.element=s.createElementNS("http://www.w3.org/2000/svg",b),this.renderer=a},animate:function(a,b){bz(this,a,b)},attr:function(a,d){var e,f,g,h=this.element,i=h.nodeName,j=this.renderer,k,l=this.shadows,m,n=this;typeof a=="string"&&b(d)&&(e=a,a={},a[e]=d);if(typeof a=="string")e=a,i=="circle"?e=({x:"cx",y:"cy"})[e]||e:e=="strokeWidth"&&(e="stroke-width"),n=parseFloat(c(h,e)||this[e]||0);else for(e in a){d=a[e];if(e=="d")d&&d.join&&(d=d.join(" ")),/(NaN|  |^$)/.test(d)&&(d="M 0 0");else if(e=="x"&&i=="text")for(f=0;f<h.childNodes.length;f++)g=h.childNodes[f],c(g,"x")==c(h,"x")&&c(g,"x",d);else e=="fill"?d=j.color(d,h,e):i=="circle"?e=({x:"cx",y:"cy"})[e]||e:e=="translateX"||e=="translateY"?(this[e]=d,this.updateTransform(),k=!0):e=="stroke"?d=j.color(d,h,e):e=="isTracker"&&(this[e]=d);e=="strokeWidth"&&(e="stroke-width"),F&&e=="stroke-width"&&d===0&&(d=1e-6),this.symbolName&&/^(x|y|r|start|end|innerR)/.test(e)&&(m||(this.symbolAttr(a),m=!0),k=!0);if(l&&/^(width|height|visibility|x|y|d)$/.test(e))for(f=l.length;f--;)c(l[f],e,d);e=="text"?j.buildText(h,d):k||c(h,e,d)}return n},symbolAttr:function(a){var b=this;b.x=e(a.x,b.x),b.y=parseFloat(e(a.y,b.y)),b.r=e(a.r,b.r),b.start=e(a.start,b.start),b.end=e(a.end,b.end),b.width=e(a.width,b.width),b.height=parseFloat(e(a.height,b.height)),b.innerR=e(a.innerR,b.innerR),b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.r,{start:b.start,end:b.end,width:b.width,height:b.height,innerR:b.innerR})})},clip:function(a){return this.attr("clip-path","url("+this.renderer.url+"#"+a.id+")")},css:function(b){var c=this;b&&b.color&&(b.fill=b.color),b=a(c.styles,b),c.attr({style:f(b)}),c.styles=b;return c},on:function(a,b){this.element["on"+a]=b;return this},translate:function(a,b){var c=this;c.translateX=a,c.translateY=b,c.updateTransform();return c},invert:function(){var a=this;a.inverted=!0,a.updateTransform();return a},updateTransform:function(){var a=this,b=a.translateX||0,d=a.translateY||0,e=a.inverted,f=[];e&&(b+=a.attr("width"),d+=a.attr("height")),(b||d)&&f.push("translate("+b+","+d+")"),e&&f.push("rotate(90) scale(-1,1)"),f.length&&c(a.element,"transform",f.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},getBBox:function(){return this.element.getBBox()},show:function(){return this.attr({visibility:V})},hide:function(){return this.attr({visibility:T})},add:function(a){var d=this.renderer,e=a||d;d=e.element||d.box;var f=d.childNodes,g=this.element,h=c(g,"zIndex"),i;this.parentInverted=a&&a.inverted,h&&(e.handleZ=!0,h=parseInt(h,10));if(e.handleZ)for(i=0;i<f.length;i++){a=f[i],e=c(a,"zIndex");if(a!=g&&(parseInt(e,10)>h||!b(h)&&b(e))){d.insertBefore(g,a);return this}}d.appendChild(g);return this},destroy:function(){var a=this,b=a.element,c=a.shadows,d=b.parentNode,e;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=null,bA(a),d&&d.removeChild(b),c&&br(c,function(a){(d=a.parentNode)&&d.removeChild(a)});for(e in a)delete a[e];return null},empty:function(){for(var a=this.element,b=a.childNodes,c=b.length;c--;)a.removeChild(b[c])},shadow:function(a){var b=[],d,e=this.element,f=this.parentInverted?"(-1,-1)":"(1,1)";if(a){for(a=1;a<=3;a++)d=e.cloneNode(0),c(d,{isShadow:"true",stroke:"rgb(0, 0, 0)","stroke-opacity":.05*a,"stroke-width":7-2*a,transform:"translate"+f,fill:X}),e.parentNode.insertBefore(d,e),b.push(d);this.shadows=b}return this}};var bM=function(){this.init.apply(this,arguments)};bM.prototype={init:function(a,b,d){var e=s.createElementNS("http://www.w3.org/2000/svg","svg"),f=location;c(e,{width:b,height:d,xmlns:"http://www.w3.org/2000/svg",version:"1.1"}),a.appendChild(e),this.Element=p,this.box=e,this.url=E?"":f.href.replace(/#.*?$/,""),this.defs=this.createElement("defs").add()},createElement:function(a){var b=new this.Element;b.init(this,a);return b},buildText:function(a,b){b=b.toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br[^>]?>/g);for(var d=a.childNodes,e=/style="([^"]+)"/,f=/href="([^"]+)"/,h=c(a,"x"),i=d.length;i--;)a.removeChild(d[i]);br(b,function(b,d){var i,j=0;b=b.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),i=b.split("|||"),br(i,function(b){if(b!==""||i.length==1){var k={},l=s.createElementNS("http://www.w3.org/2000/svg","tspan");e.test(b)&&c(l,"style",b.match(e)[1].replace(/(;| |^)color([ :])/,"$1fill$2")),f.test(b)&&(c(l,"onclick",'location.href="'+b.match(f)[1]+'"'),g(l,{cursor:"pointer"})),b=b.replace(/<(.|\n)*?>/g,""),l.appendChild(s.createTextNode(b||" ")),j?k.dx=3:k.x=h,d&&!j&&(k.dy=16),c(l,k),a.appendChild(l),j++}})})},crispLine:function(a,b){a[1]==a[4]&&(a[1]=a[4]=v(a[1])+b%2/2),a[2]==a[5]&&(a[2]=a[5]=v(a[2])+b%2/2);return a},path:function(a){return this.createElement("path").attr({d:a,fill:X})},circle:function(a,b,c){a=typeof a=="object"?a:{x:a,y:b,r:c};return this.createElement("circle").attr(a)},arc:function(a,b,c,d,e,f){typeof a=="object"&&(b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x);return this.symbol("arc",a||0,b||0,c||0,{innerR:d||0,start:e||0,end:f||0})},rect:function(b,c,d,e,f,g){if(arguments.length>1){var h=(g||0)%2/2;b=v(b||0)+h,c=v(c||0)+h,d=v((d||0)-2*h),e=v((e||0)-2*h)}h=typeof b=="object"?b:{x:b,y:c,width:y(d,0),height:y(e,0)};return this.createElement("rect").attr(a(h,{rx:f||h.r,ry:f||h.r,fill:X}))},g:function(a){return this.createElement("g").attr(b(a)&&{"class":U+a})},image:function(a,b,c,d,e){b=this.createElement("image").attr({x:b,y:c,width:d,height:e,preserveAspectRatio:X}),b.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a);return b},symbol:function(b,c,d,e,f){var g,i=this.symbols[b];i=i&&i(c,d,e,f);var j=/^url\((.*?)\)$/;i?(g=this.path(i),a(g,{symbolName:b,x:c,y:d,r:e}),f&&a(g,f)):j.test(b)?(b=b.match(j)[1],g=this.image(b).attr({visibility:T}),h("img",{onload:function(){var a=this;a=J[a.src]||[a.width,a.height],g.attr({x:v(c-a[0]/2)+W,y:v(d-a[1]/2)+W,width:a[0],height:a[1],visibility:"inherit"})},src:b})):g=this.circle(c,d,e);return g},symbols:{square:function(a,b,c){c=.707*c;return[Y,a-c,b-c,Z,a+c,b-c,a+c,b+c,a-c,b+c,"Z"]},triangle:function(a,b,c){return[Y,a,b-1.33*c,Z,a+c,b+.67*c,a-c,b+.67*c,"Z"]},"triangle-down":function(a,b,c){return[Y,a,b+1.33*c,Z,a-c,b-.67*c,a+c,b-.67*c,"Z"]},diamond:function(a,b,c){return[Y,a,b-c,Z,a+c,b,a,b+c,a-c,b,"Z"]},arc:function(a,b,c,d){var e=Math.PI,f=d.start,g=d.end-1e-6,h=d.innerR,i=B(f),j=C(f),k=B(g);g=C(g),d=d.end-f<e?0:1;return[Y,a+c*i,b+c*j,"A",c,c,0,d,1,a+c*k,b+c*g,Z,a+h*k,b+h*g,"A",h,h,0,d,0,a+h*i,b+h*j,"Z"]}},clipRect:function(a,b,c,d){var e=U+K++,f=this.createElement("clipPath").attr({id:e}).add(this.defs);a=this.rect(a,b,c,d,0).add(f),a.id=e;return a},color:function(a,b,d){var e,f=/^rgba/;if(a&&a.linearGradient){var g=this;b="linearGradient",d=a[b];var h=U+K++,i,j,k;i=g.createElement(b).attr({id:h,gradientUnits:"userSpaceOnUse",x1:d[0],y1:d[1],x2:d[2],y2:d[3]}).add(g.defs),br(a.stops,function(a){f.test(a[1])?(e=bL(a[1]),j=e.get("rgb"),k=e.get("a")):(j=a[1],k=1),g.createElement("stop").attr({offset:a[0],"stop-color":j,"stop-opacity":k}).add(i)});return"url("+this.url+"#"+h+")"}if(f.test(a)){e=bL(a),c(b,d+"-opacity",e.get("a"));return e.get("rgb")}return a},text:function(b,c,d,g,h,i){g=g||{},i=i||"left",h=h||0;var j=g.color||"#000000",k=N.chart.style;c=v(e(c,0)),d=v(e(d,0)),a(g,{fontFamily:g.fontFamily||k.fontFamily,fontSize:g.fontSize||k.fontSize}),g=f(g),b={x:c,y:d,text:b,fill:j,style:g.replace(/"/g,"'")};if(h||i!="left")b=a(b,{"text-anchor":({left:"start",center:"middle",right:"end"})[i],transform:"rotate("+h+" "+c+" "+d+")"});return this.createElement("text").attr(b)}};var bN;if(!G){var bO=m(p,{init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ",R,";"];(b=="shape"||b==Q)&&d.push("left:0;top:0;width:10px;height:10px"),c.push(' style="',d.join(""),'"/>'),b&&(c=b==Q||b=="span"||b=="img"?c.join(""):a.prepVML(c),this.element=h(c)),this.renderer=a},add:function(a){var b=this,c=b.renderer,d=b.element,e=c.box;c=a&&a.inverted,a=a?a.element||a:e,c&&(c=a.style,g(d,{flip:"x",left:parseInt(c.width,10)-10,top:parseInt(c.height,10)-10,rotation:-90})),a.appendChild(d);return b},attr:function(a,d){var f,h,i,j=this.element,k=j.style,l=j.nodeName,m=this.renderer,n=this.symbolName,o,p=this.shadows,q=s.documentMode,r,t=this;typeof a=="string"&&b(d)&&(f=a,a={},a[f]=d);if(typeof a=="string")f=a,t=f=="strokeWidth"||f=="stroke-width"?j.strokeweight:e(this[f],parseInt(k[({x:"left",y:"top"})[f]||f],10));else for(f in a){h=a[f],r=!1;if(n&&/^(x|y|r|start|end|width|height|innerR)/.test(f))o||(this.symbolAttr(a),o=!0),r=!0;else if(f=="d"){i=h.length;for(r=[];i--;)r[i]=typeof h[i]=="number"?v(h[i]*10)-5:h[i]=="Z"?"x":h[i];h=r.join(" ")||"x",j.path=h;if(p)for(i=p.length;i--;)p[i].path=h;r=!0}else if(f=="zIndex"||f=="visibility")k[f]=h,q==8&&f=="visibility"&&l=="DIV"&&br(j.childNodes,function(a){g(a,{visibility:h})}),r=!0;else if(/^(width|height)$/.test(f))k[f]=h,this.updateClipping&&this.updateClipping(),r=!0;else if(/^(x|y)$/.test(f))f=="y"&&j.tagName=="SPAN"&&j.lineHeight&&(h-=j.lineHeight),k[({x:"left",y:"top"})[f]]=h;else if(f=="class")j.className=h;else if(f=="stroke")h=m.color(h,j,f),f="strokecolor";else if(f=="stroke-width"||f=="strokeWidth")j.stroked=h?!0:!1,f="strokeweight",typeof h=="number"&&(h+=W);else if(f=="fill")l=="SPAN"?k.color=h:(j.filled=h!=X?!0:!1,h=m.color(h,j,f),f="fillcolor");else if(f=="translateX"||f=="translateY")this[f]=d,this.updateTransform(),r=!0;if(p&&f=="visibility")for(i=p.length;i--;)p[i].style[f]=h;f=="text"?j.innerHTML=h:r||(q==8?j[f]=h:c(j,f,h))}return t},clip:function(a){var b=this,c=a.members,d=c.length;c.push(b),b.destroyClip=function(){c.splice(d,1)};return b.css(a.getCSS(b.inverted))},css:function(a){var b=this;g(b.element,a);return b},destroy:function(){var a=this;a.destroyClip&&a.destroyClip(),p.prototype.destroy.apply(this)},empty:function(){var a=this.element;a=a.childNodes;for(var b=a.length,c;b--;)c=a[b],c.parentNode.removeChild(c)},getBBox:function(){var a=this.element,b,c=a.offsetWidth,d=a.parentNode;c||s.body.appendChild(a),b={x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight},c||(d?d.appendChild(a):s.body.removeChild(a));return b},on:function(a,b){this.element["on"+a]=function(){var a=t.event;a.target=a.srcElement,b(a)};return this},updateTransform:function(){var a=this,b=a.translateX||0,c=a.translateY||0;(b||c)&&a.css({left:b,top:c})},shadow:function(a){var b=[],c=this.element,d=this.renderer,e,f=c.style,g,i=c.path;""+c.path==""&&(i="x");if(a){for(a=1;a<=3;a++)g=['<shape isShadow="true" strokeweight="',7-2*a,'" filled="false" path="',i,'" coordsize="100,100" style="',c.style.cssText,'" />'],e=h(d.prepVML(g),null,{left:parseInt(f.left,10)+1,top:parseInt(f.top,10)+1}),g=['<stroke color="black" opacity="',.05*a,'"/>'],h(d.prepVML(g),null,null,e),c.parentNode.insertBefore(e,c),b.push(e);this.shadows=b}return this}});bN=function(){this.init.apply(this,arguments)},bN.prototype=bu(bM.prototype,{isIE8:D.indexOf("MSIE 8.0")>-1,init:function(a,b,c){this.width=b,this.height=c,this.box=h(Q,null,{width:b+W,height:c+W},a),this.Element=bO,s.namespaces.hcv||(s.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),s.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:textpath, hcv\\:shape, hcv\\:stroke, hcv\\:line { behavior:url(#default#VML); display: inline-block; } ")},clipRect:function(b,c,d,e){var f=this.createElement();return a(f,{members:[],element:{style:{left:b,top:c,width:d,height:e}},getCSS:function(b){var c=f.element.style,d=c.top,e=c.left,g=e+c.width;c=d+c.height,d={clip:"rect("+(b?e:d)+"px,"+(b?c:g)+"px,"+(b?g:c)+"px,"+(b?d:e)+"px)"},!b&&s.documentMode==8&&a(d,{width:g+W,height:c+W});return d},updateClipping:function(){br(f.members,function(a){a.css(f.getCSS(a.inverted))})}})},color:function(a,b,c){var d,e=/^rgba/;if(!a||!a.linearGradient){if(e.test(a)){d=bL(a),c=["<",c,' opacity="',d.get("a"),'"/>'],h(this.prepVML(c),null,null,b);return d.get("rgb")}return a}var f,g,i=a.linearGradient,j,k,l,m;br(a.stops,function(a,b){e.test(a[1])?(d=bL(a[1]),f=d.get("rgb"),g=d.get("a")):(f=a[1],g=1),b?(l=f,m=g):(j=f,k=g)}),a=90-u.atan((i[3]-i[1])/(i[2]-i[0]))*180/u.PI,c=["<",c,' colors="0% ',j,",100% ",l,'" angle="',a,'" opacity="',m,'" o:opacity2="',k,'" type="gradient" focus="100%" />'],h(this.prepVML(c),null,null,b)},prepVML:function(a){var b="display:inline-block;behavior:url(#default#VML);",c=this.isIE8;try{a=a.join("")}catch(d){for(var e="",f=0;f<a.length;f++)e+=a[f];a=e}c?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')==-1?a.replace("/>",' style="'+b+'" />'):a.replace('style="','style="'+b)):a=a.replace("<","<hcv:");return a},text:function(b,c,d,e,i,j){e=e||{},j=j||"left",i=i||0;var k=v(parseInt(e.fontSize||12,10)*1.2),l=N.chart.style;c=v(c),d=v(d),a(e,{color:e.color||"#000000",whiteSpace:"nowrap",fontFamily:e.fontFamily||l.fontFamily,fontSize:e.fontSize||l.fontSize});if(i){l=(i||0)*u.PI*2/360,i=B(l),l=C(l);var m=10;k=k*.3;var n=j=="left",o=j=="right",p=n?c:c-m*i;c=o?c:c+m*i,n=n?d:d-m*l,d=o?d:d+m*l,p+=k*l,c+=k*l,n-=k*i,d-=k*i,A(p-c)<.1&&(p+=.1),A(n-d)<.1&&(n+=.1),d=this.createElement("line").attr({from:p+", "+n,to:c+", "+d}),i=d.element,h("hcv:fill",{on:!0,color:e.color},null,i),h("hcv:path",{textpathok:!0},null,i),h('<hcv:textpath style="v-text-align:'+j+";"+f(e).replace(/"/g,"'")+'" on="true" string="'+b.toString().replace(/<br[^>]?>/g,"\n")+'">',null,null,i)}else d=this.createElement("span").attr({x:c,y:d-k,text:b}),i=d.element,i.lineHeight=k,g(i,e),j!="left"&&(b=d.getBBox().width,g(i,{left:c-b/({right:1,center:2})[j]+W}));return d},path:function(a){return this.createElement("shape").attr({coordsize:"100 100",d:a})},circle:function(a,b,c){return this.path(this.symbols.circle(a,b,c))},g:function(a){var b;a&&(b={className:U+a,"class":U+a});return a=this.createElement(Q).attr(b)},image:function(a,b,c,d,e){return this.createElement("img").attr({src:a}).css({left:b,top:c,width:d,height:e})},rect:function(a,b,c,d,e,f){if(arguments.length>1){var g=(f||0)%2/2;a=v(a||0)+g,b=v(b||0)+g,c=v((c||0)-2*g),d=v((d||0)-2*g)}typeof a=="object"&&(b=a.y,c=a.width,d=a.height,e=a.r,a=a.x);return this.symbol("rect",a||0,b||0,e||0,{width:c||0,height:d||0})},symbol:function(a,b,c){var d;d=/^url\((.*?)\)$/;return d=d.test(a)?this.createElement("img").attr({onload:function(){var a=this,d=[a.width,a.height];g(a,{left:v(b-d[0]/2),top:v(c-d[1]/2)})},src:a.match(d)[1]}):bM.prototype.symbol.apply(this,arguments)},symbols:{arc:function(a,b,c,d){var e=d.start,f=d.end,g=f-e==2*Math.PI?f-.001:f,h=B(e),i=C(e),j=B(g);g=C(g),d=d.innerR;if(f-e===0)return["x"];return["wa",a-c,b-c,a+c,b+c,a+c*h,b+c*i,a+c*j,b+c*g,"at",a-d,b-d,a+d,b+d,a+d*j,b+d*g,a+d*h,b+d*i,"x","e"]},circle:function(a,b,c){return["wa",a-c,b-c,a+c,b+c,a+c,b,a+c,b,"e"]},rect:function(a,b,c,d){var e=d.width;d=d.height;var f=a+e,g=b+d;c=z(c,e,d);return[Y,a+c,b,Z,f-c,b,"wa",f-2*c,b,f,b+2*c,f-c,b,f,b+c,Z,f,g-c,"wa",f-2*c,g-2*c,f,g,f,g-c,f-c,g,Z,a+c,g,"wa",a,g-2*c,a+2*c,g,a+c,g,a,g-c,Z,a,b+c,"wa",a,b,a+2*c,b+2*c,a,b+c,a+c,b,"x","e"]}}})}var bP=G?bM:bN,bQ=function(){};bQ.prototype={init:function(a,b){var c=this;c.series=a,c.applyOptions(b),c.pointAttr={},a.options.colorByPoint&&(a=a.chart.options.colors,c.options||(c.options={}),c.color=c.options.color=c.color||a[H++],H>=a.length&&(H=0));return c},applyOptions:function(b){var c=this,d=c.series;c.config=b,typeof b=="number"||b===null?c.y=b:typeof b=="object"&&typeof b.length!="number"?(a(c,b),c.options=b):typeof b[0]=="string"?(c.name=b[0],c.y=b[1]):typeof b[0]=="number"&&(c.x=b[0],c.y=b[1]),c.x===P&&(c.x=d.autoIncrement())},destroy:function(){var a=this,b;a==a.series.chart.hoverPoint&&a.onMouseOut(),bx(a),br(["dataLabel","graphic","tracker","group"],function(b){a[b]&&a[b].destroy()}),a.legendItem&&a.series.chart.legend.destroyItem(a);for(b in a)a[b]=null},select:function(a,b){var c=this,d=c.series;d=d.chart,c.selected=a=e(a,!c.selected),c.firePointEvent(a?"select":"unselect"),c.setState(a&&bc),b||br(d.getSelectedPoints(),function(a){a.selected&&a!=c&&(a.selected=!1,a.setState(ba),a.firePointEvent("unselect"))})},onMouseOver:function(){var a=this,b=a.series.chart,c=b.tooltip,d=b.hoverPoint;d&&d!=a&&d.onMouseOut(),a.firePointEvent("mouseOver"),c&&c.refresh(a),a.setState(bb),b.hoverPoint=a},onMouseOut:function(){var a=this;a.firePointEvent("mouseOut"),a.setState(ba),a.series.chart.hoverPoint=null},update:function(a,b){var c=this,d=c.series;b=e(b,!0),c.firePointEvent("update",{options:a},function(){c.applyOptions(a),d.isDirty=!0,b&&d.chart.redraw()})},remove:function(a){var b=this,c=b.series,d=c.chart,f=c.data,g=f.length;a=e(a,!0),b.firePointEvent("remove",null,function(){for(;g--;)if(f[g]==b){f.splice(g,1);break}b.destroy(),c.isDirty=!0,a&&d.redraw()})},firePointEvent:function(a,b,c){var d=this,e=this.series;e=e.options,(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents(),a=="click"&&e.allowPointSelect&&(c=function(a){d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)}),by(this,a,b,c)},importEvents:function(){if(!this.hasImportedEvents){var a=this,b=bu(a.series.options.point,a.options);b=b.events;var c;a.events=b;for(c in b)bw(a,c,b[c]);this.hasImportedEvents=!0}},setState:function(a){var b=this,c=b.series,d=c.options.states,e=c.options.marker,f=e&&!e.enabled,g=(e=e&&e.states[a])&&e.enabled===!1,h=c.chart,i=b.pointAttr;a||(a=ba),b.selected&&a!=bc||d[a]&&d[a].enabled===!1||a&&(g||f&&!e.enabled)||(a&&!b.graphic?(c.stateMarkerGraphic||(c.stateMarkerGraphic=h.renderer.circle(0,0,i[a].r).attr(i[a]).add(c.group)),c.stateMarkerGraphic.translate(b.plotX,b.plotY)):b.graphic&&b.graphic.attr(i[a]))},setTooltipText:function(){var a=this;a.tooltipText=a.series.chart.options.tooltip.formatter.call({series:a.series,point:a,x:a.category,y:a.y,percentage:a.percentage,total:a.total||a.stackTotal})}};var bR=function(){};bR.prototype={isCartesian:!0,type:"line",pointClass:bQ,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},init:function(b,c){var d=this,e,f=b.series.length;d.chart=b,c=d.setOptions(c),a(d,{index:f,options:c,name:c.name||"Series "+(f+1),state:ba,pointAttr:{},visible:c.visible!==!1,selected:c.selected===!0}),b=c.events;for(e in b)bw(d,e,b[e]);d.getColor(),d.getSymbol(),d.setData(c.data,!1)},autoIncrement:function(){var a=this,b=a.options,c=a.xIncrement;c=e(c,b.pointStart,0),a.pointInterval=e(a.pointInterval,b.pointInterval,1),a.xIncrement=c+a.pointInterval;return c},cleanData:function(){var a=this;a=a.data;var b;a.sort(function(a,b){return a.x-b.x});for(b=a.length-1;b>=0;b--)a[b-1]&&a[b-1].x==a[b].x&&a.splice(b-1,1)},getSegments:function(){var a=-1,b=[],c=this.data;br(c,function(d,e){d.y===null?(e>a+1&&b.push(c.slice(a+1,e)),a=e):e==c.length-1&&b.push(c.slice(a+1,e+1))}),this.segments=b},setOptions:function(a){var b=this.chart.options.plotOptions;return a=bu(b[this.type],b.series,a)},getColor:function(){var a=this.chart.options.colors;this.color=this.options.color||a[H++]||"#0000ff",H>=a.length&&(H=0)},getSymbol:function(){var a=this.chart.options.symbols,b=this.options.marker.symbol||a[I++];this.symbol=b,I>=a.length&&(I=0)},addPoint:function(a,b,c){var d=this,f=d.data;a=(new d.pointClass).init(d,a),b=e(b,!0),f.push(a),c&&f[0].remove(!1),d.isDirty=!0,b&&d.chart.redraw()},setData:function(a,c){var f=this,g=f.data,h=f.initialColor,i=g&&g.length||0;f.xIncrement=null,b(h)&&(H=h);for(a=bt(d(a||[]),function(a){return(new f.pointClass).init(f,a)});i--;)g[i].destroy();f.data=a,f.cleanData(),f.getSegments(),f.isDirty=!0,e(c,!0)&&f.chart.redraw()},remove:function(a){var b=this,c=b.chart;a=e(a,!0),b.isRemoving||(b.isRemoving=!0,by(b,"remove",null,function(){b.destroy(),c.isDirty=!0,a&&c.redraw()})),b.isRemoving=!1},translate:function(){for(var a=this,b=a.chart,c=a.options.stacking,d=a.xAxis.categories,e=a.yAxis,f=e.stacks[a.type],g=a.data,h=g.length;h--;){var i=g[h],j=i.x,k=i.y,l;i.plotX=a.xAxis.translate(j),c&&a.visible&&f[j]&&(l=f[j],j=l.total,l.cum=l=l.cum-k,k=l+k,c=="percent"&&(l=j?l*100/j:0,k=j?k*100/j:0),i.percentage=j?i.y*100/j:0,i.stackTotal=j,i.yBottom=e.translate(l,0,1)),k!==null&&(i.plotY=e.translate(k,0,1)),i.clientX=b.inverted?b.plotHeight-i.plotX:i.plotX,i.category=d&&d[i.x]!==P?d[i.x]:i.x}},setTooltipPoints:function(a){var b=this,c=b.chart,d=c.inverted,e=[],f=(d?c.plotTop:c.plotLeft)+c.plotSizeX,g,h,i=[];a&&(b.tooltipPoints=null),br(b.segments,function(a){e=e.concat(a)}),b.xAxis&&b.xAxis.reversed&&(e=e.reverse()),br(e,function(a,c){b.tooltipPoints||a.setTooltipText(),g=e[c-1]?e[c-1].high+1:0;for(h=a.high=e[c+1]?w((a.plotX+(e[c+1]?e[c+1].plotX:f))/2):f;g<=h;)i[d?f-g++:g++]=a}),b.tooltipPoints=i},onMouseOver:function(){var a=this,b=a.chart,c=b.hoverSeries,d=a.stateMarkerGraphic;b.mouseIsDown||(d&&d.show(),c&&c!=a&&c.onMouseOut(),a.options.events.mouseOver&&by(a,"mouseOver"),a.tracker&&a.tracker.toFront(),a.setState(bb),b.hoverSeries=a)},onMouseOut:function(){var a=this,b=a.options,c=a.chart,d=c.tooltip,e=c.hoverPoint;e&&e.onMouseOut(),a&&b.events.mouseOut&&by(a,"mouseOut"),d&&!b.stickyTracking&&d.hide(),a.setState(),c.hoverSeries=null},animate:function(a){var b=this,c=b.chart,d=b.clipRect;a?d.isAnimating||(d.attr("width",0),d.isAnimating=!0):(d.animate({width:c.plotSizeX},{complete:function(){d.isAnimating=!1},duration:1e3}),this.animate=null)},drawPoints:function(){var a=this,b,c=a.data,d=a.chart,f,g,h,i,j,k;if(a.options.marker.enabled)for(h=c.length;h--;)i=c[h],f=i.plotX,g=i.plotY,k=i.graphic,g!==P&&(b=i.pointAttr[i.selected?bc:ba],j=b.r,k?k.attr({x:f,y:g,r:j}):i.graphic=d.renderer.symbol(e(i.marker&&i.marker.symbol,a.symbol),f,g,j).attr(b).add(a.group))},convertAttribs:function(a,b,c,d){var f=this.pointAttrToOptions,g,h,i={};a=a||{},b=b||{},c=c||{},d=d||{};for(g in f)h=f[g],i[g]=e(a[h],b[g],c[g],d[g]);return i},getAttribs:function(){var a=this,c=a.options.marker||a.options,d=c.states,e=d[bb],f,g={},h=a.color,i=a.data,j=[],k,l=a.pointAttrToOptions;a.options.marker?(g={stroke:h,fill:h},e.radius=e.radius||c.radius+2,e.lineWidth=e.lineWidth||c.lineWidth+1):(g={fill:h},e.color=e.color||bL(e.color||h).brighten(e.brightness).get()),j[ba]=a.convertAttribs(c,g),br([bb,bc],function(b){j[b]=a.convertAttribs(d[b],j[ba])}),a.pointAttr=j;for(g=i.length;g--;){h=i[g],(c=h.options&&h.options.marker||h.options)&&c.enabled===!1&&(c.radius=0),f=!1;if(h.options)for(var m in l)b(c[l[m]])&&(f=!0);f?(k=[],d=c.states||{},f=d[bb]=d[bb]||{},a.options.marker||(f.color=bL(f.color||h.options.color).brighten(f.brightness||e.brightness).get()),k[ba]=a.convertAttribs(c,j[ba]),k[bb]=a.convertAttribs(d[bb],j[bb],k[ba]),k[bc]=a.convertAttribs(d[bc],j[bc],k[ba])):k=j,h.pointAttr=k}},destroy:function(){var a=this,b=a.chart,c=b.series,d=a.clipRect,e;bx(a),a.legendItem&&a.chart.legend.destroyItem(a),br(a.data,function(a){a.destroy()}),br(["area","graph","dataLabelsGroup","group","tracker"],function(b){a[b]&&a[b].destroy()}),d&&d!=a.chart.clipRect&&d.destroy(),b.hoverSeries==a&&(b.hoverSeries=null),br(c,function(b,d){b==a&&c.splice(d,1)});for(e in a)delete a[e]},drawDataLabels:function(){if(this.options.dataLabels.enabled){var a=this,b,c,d=a.data,f=a.options.dataLabels,g,h=a.dataLabelsGroup,i=a.chart,j=i.inverted,k=a.type,l,m;h||(h=a.dataLabelsGroup=i.renderer.g(U+"data-labels").attr({visibility:a.visible?V:T,zIndex:4}).translate(i.plotLeft,i.plotTop).add()),l=f.color,l=="auto"&&(l=null),f.style.color=e(l,a.color),br(d,function(d){var l=e(d.barX,d.plotX),n=d.plotY,o=d.tooltipPos,p=d.dataLabel;p&&(d.dataLabel=p.destroy()),g=f.formatter.call({x:d.x,y:d.y,series:a,point:d,percentage:d.percentage,total:d.total||d.stackTotal}),b=(j?i.plotWidth-n:l)+f.x,c=(j?i.plotHeight-l:n)+f.y,o&&(b=o[0]+f.x,c=o[1]+f.y),m=f.align,k=="column"&&(b+=({center:d.barW/2,right:d.barW})[m]||0),g&&(d.dataLabel=i.renderer.text(g,b,c,f.style,f.rotation,m).attr({zIndex:1,visibility:d.visible===!1?T:"inherit"}).add(h)),a.drawConnector&&a.drawConnector(d)})}},drawGraph:function(){var a=this,b=a.options,c=a.chart,d=a.graph,f=[],g=a.area,h=a.group,i=b.lineColor||a.color,j=b.lineWidth,k,l=c.renderer,m=a.yAxis.getThreshold(b.threshold||0),n=/^area/.test(a.type),o=[],p=[];br(a.segments,function(c){if(c.length>1){k=[],br(c,function(a,d){d<2&&k.push([Y,Z][d]),d&&b.step&&(d=c[d-1],k.push(a.plotX,d.plotY)),k.push(a.plotX,a.plotY)}),f=f.concat(k);if(n){var d=[],e,g=k.length;for(e=0;e<g;e++)d.push(k[e]);if(b.stacking&&a.type!="areaspline")for(e=c.length-1;e>=0;e--)d.push(c[e].plotX,c[e].yBottom);else d.push(c[c.length-1].plotX,m,c[0].plotX,m,"z");p=p.concat(d)}}else o.push(c[0])}),a.graphPath=f,a.singlePoints=o,n&&(c=e(b.fillColor,bL(a.color).setOpacity(b.fillOpacity||.75).get()),g?g.attr({d:p}):a.area=a.chart.renderer.path(p).attr({fill:c}).add(a.group)),d?d.attr({d:f}):j&&(a.graph=l.path(f).attr({stroke:i,"stroke-width":j+W}).add(h).shadow(b.shadow))},render:function(){var a=this,b=a.chart,c,d=a.options.animation&&a.animate;c=b.renderer,a.clipRect||(a.clipRect=!b.hasRendered&&b.clipRect?b.clipRect:c.clipRect(0,0,b.plotSizeX,b.plotSizeY),b.clipRect||(b.clipRect=a.clipRect)),a.group||(c=a.group=c.g("series"),b.inverted&&c.attr({width:b.plotWidth,height:b.plotHeight}).invert(),c.clip(a.clipRect).attr({visibility:a.visible?V:T,zIndex:3}).translate(b.plotLeft,b.plotTop).add()),a.drawDataLabels(),d&&a.animate(!0),a.getAttribs(),a.drawGraph&&a.drawGraph(),a.drawPoints(),a.options.enableMouseTracking!==!1&&a.drawTracker(),d&&a.animate(),a.isDirty=!1},redraw:function(){var a=this;a.translate(),a.setTooltipPoints(!0),a.render()},setState:function(a){var b=this,c=b.options,d=b.graph,e=c.states,f=b.stateMarkerGraphic;c=c.lineWidth,a=a||ba;if(b.state!=a){b.state=a;if(!e[a]||e[a].enabled!==!1)a?c=e[a].lineWidth||c:f&&f.hide(),d&&d.animate({"stroke-width":c},a?0:500)}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f=c.group,g=c.tracker,h=c.dataLabelsGroup,i,j=c.data,k=d.options.chart.ignoreHiddenSeries;i=c.visible,i=(c.visible=a=a===P?!i:a)?"show":"hide",a&&(c.isDirty=k),f&&f[i]();if(g)g[i]();else for(f=j.length;f--;)g=j[f],g.tracker&&g.tracker[i]();h&&h[i](),e&&d.legend.colorizeItem(c,a),k&&c.options.stacking&&br(d.series,function(a){a.options.stacking&&a.visible&&(a.isDirty=!0)}),b!==!1&&d.redraw(),by(c,i)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){var b=this;b.selected=a=a===P?!b.selected:a,b.checkbox&&(b.checkbox.checked=a),by(b,a?"select":"unselect")},drawTracker:function(){var a=this,b=a.options,c=a.graphPath,d=a.chart,e=d.options.tooltip.snap,f=a.tracker,g=b.cursor;g=g&&{cursor:g};var h=a.singlePoints,i,j;for(j=0;j<h.length;j++)i=h[j],c.push(Y,i.plotX-3,i.plotY,Z,i.plotX+3,i.plotY);f?f.attr({d:c}):a.tracker=d.renderer.path(c).attr({isTracker:!0,stroke:_,fill:X,"stroke-width":b.lineWidth+2*e,"stroke-linecap":"round",visibility:a.visible?V:T,zIndex:1}).on("mouseover",function(){d.hoverSeries!=a&&a.onMouseOver()}).on("mouseout",function(){b.stickyTracking||a.onMouseOut()}).css(g).add(d.trackerGroup)}},D=m(bR),bB.line=D,D=m(bR,{type:"area"}),bB.area=D,r.prototype={get:function(a){a||(a=50);var b=this.n;b=(this.xdata[b-1]-this.xdata[0])/(a-1);var c=[],d=[];c[0]=this.xdata[0],d[0]=this.ydata[0];for(var e=[{plotX:c[0],plotY:d[0]}],f=1;f<a;f++)c[f]=c[0]+f*b,d[f]=this.interpolate(c[f]),e[f]={plotX:c[f],plotY:d[f]};return e},interpolate:function(a){for(var b=this.n-1,c=0;b-c>1;){var d=(b+c)/2;this.xdata[w(d)]>a?b=d:c=d}b=w(b),c=w(c),d=this.xdata[b]-this.xdata[c];var e=(this.xdata[b]-a)/d;a=(a-this.xdata[c])/d;return e*this.ydata[c]+a*this.ydata[b]+((e*e*e-e)*this.y2[c]+(a*a*a-a)*this.y2[b])*d*d/6}},D=m(bR,{type:"spline",drawGraph:function(){var a=this,b=a.segments;a.splinedata=a.getSplineData(),a.segments=a.splinedata,bR.prototype.drawGraph.apply(a,arguments),a.segments=b},getSplineData:function(){var a=this,b=a.chart,c=[],d=b.plotSizeX,e;br(a.segments,function(b){a.xAxis.reversed&&(b=b.reverse());var f=[],g,h;br(b,function(a,c){g=b[c+2]||b[c+1]||a,h=b[c-2]||b[c-1]||a,g.plotX>=0&&h.plotX<=d&&f.push(a)}),f.length>1&&(e=v(y(d,f[f.length-1].clientX-f[0].clientX)/3)),c.push(b.length>1?e?(new r(f)).get(e):[]:b)});return c}}),bB.spline=D,D=m(D,{type:"areaspline"}),bB.areaspline=D;var bS=m(bR,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},init:function(){bR.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&br(b.series,function(b){b.type==a.type&&(b.isDirty=!0)})},translate:function(){var c=this,d=c.chart,f=0,g=c.xAxis.reversed,h=c.xAxis.categories,i;bR.prototype.translate.apply(c),br(d.series,function(a){a.type==c.type&&(a.options.stacking?(b(i)||(i=f++),a.columnIndex=i):a.columnIndex=f++)});var j=c.options,k=c.data,l=c.closestPoints;d=A(k[1]?k[l].plotX-k[l-1].plotX:d.plotSizeX/(h?h.length:1)),h=d*j.groupPadding,l=d-2*h,l=l/f;var m=j.pointWidth,n=b(m)?(l-m)/2:l*j.pointPadding,o=e(m,l-2*n);m=(g?f-c.columnIndex:c.columnIndex)||0;var p=n+(h+m*l-d/2)*(g?-1:1),q=c.yAxis.getThreshold(j.threshold||0),r=j.minPointLength;br(k,function(c){var d=c.plotY,e=c.plotX+p,f=x(z(d,q)),g=o,h=x(A((c.yBottom||q)-d)),i;A(h)<(r||5)&&(r&&(h=r,f=q-(d<=q?r:0)),i=f-3),a(c,{barX:e,barY:f,barW:g,barH:h}),c.shapeType="rect",c.shapeArgs={x:e,y:f,width:g,height:h,r:j.borderRadius},c.trackerArgs=b(i)&&bu(c.shapeArgs,{height:6,y:i})})},getSymbol:function(){},drawGraph:function(){},drawPoints:function(){var a=this,c=a.options,d=a.chart.renderer,e,f;br(a.data,function(g){b(g.plotY)&&(e=g.graphic,f=g.shapeArgs,e?e.attr(f):g.graphic=d[g.shapeType](f).attr(g.pointAttr[g.selected?bc:ba]).add(a.group).shadow(c.shadow))})},drawTracker:function(){var a=this,b=a.chart,d=b.renderer,e,f,g=+(new Date),h=a.options.cursor,i=h&&{cursor:h},j;br(a.data,function(h){f=h.tracker,e=h.trackerArgs||h.shapeArgs,f?f.attr(e):h.tracker=d[h.shapeType](e).attr({isTracker:g,fill:_,visibility:a.visible?V:T,zIndex:1}).on("mouseover",function(d){j=d.relatedTarget||d.fromElement,b.hoverSeries!=a&&c(j,"isTracker")!=g&&a.onMouseOver(),h.onMouseOver()}).on("mouseout",function(b){a.options.stickyTracking||(j=b.relatedTarget||b.toElement,c(j,"isTracker")!=g&&a.onMouseOut())}).css(i).add(b.trackerGroup)})},cleanData:function(){var a=this,b=a.data,c,d,e,f;bR.prototype.cleanData.apply(a);for(f=b.length-1;f>=0;f--)if(b[f-1]){c=b[f].x-b[f-1].x;if(d===P||c<d)d=c,e=f}a.closestPoints=e},animate:function(a){var b=this,c=b.data;a||(br(c,function(a){var c=a.graphic;c&&(c.attr({height:0,y:b.yAxis.translate(0,0,1)}),c.animate({height:a.barH,y:a.barY},{duration:1e3}))}),b.animate=null)},remove:function(){var a=this,b=a.chart;b.hasRendered&&br(b.series,function(b){b.type==a.type&&(b.isDirty=!0)}),bR.prototype.remove.apply(a,arguments)}});bB.column=bS,D=m(bS,{type:"bar",init:function(a){a.inverted=this.inverted=!0,bS.prototype.init.apply(this,arguments)}}),bB.bar=D,D=m(bR,{type:"scatter",translate:function(){var a=this;bR.prototype.translate.apply(a),br(a.data,function(b){b.shapeType="circle",b.shapeArgs={x:b.plotX,y:b.plotY,r:a.chart.options.tooltip.snap}})},drawTracker:function(){var a=this,b=a.options.cursor,c=b&&{cursor:b},d;br(a.data,function(b){(d=b.graphic)&&d.attr({isTracker:!0}).on("mouseover",function(){a.onMouseOver(),b.onMouseOver()}).on("mouseout",function(){a.options.stickyTracking||a.onMouseOut()}).css(c)})},cleanData:function(){}}),bB.scatter=D,D=m(bQ,{init:function(){bQ.prototype.init.apply(this,arguments);var b=this,c;a(b,{visible:b.visible!==!1,name:e(b.name,"Slice")}),c=function(){b.slice()},bw(b,"select",c),bw(b,"unselect",c);return b},setVisible:function(a){var b=this,c=b.series.chart,d;d=(b.visible=a=a===P?!b.visible:a)?"show":"hide",b.group[d](),b.tracker&&b.tracker[d](),b.dataLabel&&b.dataLabel[d](),b.legendItem&&c.legend.colorizeItem(b,a)},slice:function(a,c){var d=this,f=d.series;f=f.chart;var g=d.slicedTranslation;e(c,!0),a=d.sliced=b(a)?a:!d.sliced,d.group.animate({translateX:a?g[0]:f.plotLeft,translateY:a?g[1]:f.plotTop},100)}}),D=m(bR,{type:"pie",isCartesian:!1,pointClass:D,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:function(){this.initialColor=H},translate:function(){var a=0,b=this,c=-.25,d=b.options,e=d.slicedOffset,f=d.center,g=b.chart,h=g.plotWidth,i=g.plotHeight,j,k,l;b=b.data;var m=2*u.PI,n,o=z(h,i),p;f.push(d.size,d.innerSize||0),f=bt(f,function(a,b){return(p=/%$/.test(a))?[h,i,o,o][b]*parseInt(a,10)/100:a}),br(b,function(b){a+=b.y}),br(b,function(b){n=a?b.y/a:0,j=c*m,c+=n,k=c*m,b.shapeType="arc",b.shapeArgs={x:f[0],y:f[1],r:f[2]/2,innerR:f[3]/2,start:j,end:k},l=(k+j)/2,b.slicedTranslation=bt([B(l)*e+g.plotLeft,C(l)*e+g.plotTop],v),b.tooltipPos=[f[0]+B(l)*f[2]*.35,f[1]+C(l)*f[2]*.35],b.percentage=n*100,b.total=a}),this.setTooltipPoints()},render:function(){var a=this;a.getAttribs(),this.drawPoints(),a.options.enableMouseTracking!==!1&&a.drawTracker(),this.drawDataLabels(),a.isDirty=!1},drawPoints:function(){var a=this,b=a.chart,c=b.renderer,d,e,f;br(a.data,function(a){e=a.graphic,f=a.shapeArgs,a.group||(d=a.sliced?a.slicedTranslation:[b.plotLeft,b.plotTop],a.group=c.g("point").attr({zIndex:3}).add().translate(d[0],d[1])),e?e.attr(f):a.graphic=c.arc(f).attr(a.pointAttr[ba]).add(a.group),a.visible===!1&&a.setVisible(!1)})},drawTracker:bS.prototype.drawTracker,getSymbol:function(){}}),bB.pie=D,t.Highcharts={Chart:q,dateFormat:O,getOptions:k,numberFormat:n,Point:bQ,Renderer:bP,seriesTypes:bB,setOptions:j,Series:bR,addEvent:bw,createElement:h,discardElement:l,css:g,each:br,extend:a,map:bt,merge:bu,pick:e,extendClass:m}}(),define("lib/highcharts",function(){}),define("define/chart",["define/form","define/viewelement","lib/highcharts"],function(a,b){var c=b.extend({constructor:function(a,b){this.options={chart:{marginBottom:50,renderTo:null,zoomType:"",events:{}},tooltip:{formatter:null},events:{},plotOptions:{series:{point:{events:{}},events:{click:null}},line:{animation:!0},pie:{dataLabels:{enabled:!0,formatter:function(){return this.point.name}},borderColor:"#000000",borderWidth:2,allowPointSelect:!1,cursor:"pointer",enableMouseTracking:!0,stickyTracking:!1,states:{hover:{brightness:-.1,enabled:!0}},point:{events:{mouseOver:function(){},mouseOut:function(){}}}},column:{dataLabels:{enabled:!0},allowPointSelect:!1,cursor:"pointer",enableMouseTracking:!0,stickyTracking:!1,states:{hover:{brightness:-.1,enabled:!0}}}},credits:{enabled:!1},legend:{enabled:!1},title:{text:null},series:[{name:null,data:null}]},this.base(a,b)},gainedFocus:function(){this.chart.xAxis[0].isDirty=!0,this.chart.yAxis[0].isDirty=!0,this.chart.isDirty=!0,this.chart.series[0].isDirty=!0,this.updateChart()},updateChart:function(){}},{UNSELECTED_COLOR:"#C5C5C5",SELECTED_COLOR:"#99BDF1",EXCLUDE_COLOR:"#EE3A43",INCLUDE_COLOR:"#99BDF1",ALTERNATE_GRID_COLOR:"#FDFFD5",MINIMUM_SLICE:.04,map_data_to_display:function(a){var b={};$.each(a,function(a,c){b[c[0]]=c[1]});return b},map_display_to_data:function(a){var b={};$.each(a,function(a,c){b[c[1]]=c[0]});return b},nb_plural_to_singular_map:{"in":"exact","-in":"-exact"},nb_singular_to_plural_map:{exact:"in","-exact":"-in"}}),d=c.extend({constructor:function(b,d){this.selected=[];var e=this.map=c.map_data_to_display(b.data.choices),f=this.unmap=c.map_display_to_data(b.data.choices);this.negated=!1,this.range_form=new a({fields:[{datatype:"string",name:b.data.name,choices:b.data.choices,pk:b.data.pk}]},d),this.range_form=this.range_form.dom,this.range_form.find("select[multiple]").hide(),this.range_form.find("input").css("margin","10px"),$.each(b.data.coords,function(a,c){b.data.coords[a][0]=e[b.data.coords[a][0]]}),this.base(b,d)},notify:function(){this.dom.trigger("ElementChangedEvent",[{name:this.concept_pk+"_"+this.viewset.data.pk,value:this.selected}])},elementChanged:function(a,b){b.value!==null&&(b.value==="in"?this.negated=!1:this.negated=!0,this.updateChart())},updateDS:function(a,b){this.selected=b[this.concept_pk+"_"+this.viewset.data.pk],this.selected===undefined?this.selected=[]:$.isArray(this.selected)||(this.selected=[this.selected]),this.negated=b[this.concept_pk+"_"+this.viewset.data.pk+"_operator"]==="-in",this.range_form.triggerHandler(a,[b])},updateElement:function(a,b){b.name===this.concept_pk+"_"+this.viewset.data.pk?this.selected=b.value:b.name===this.concept_pk+"_"+this.viewset.data.pk+"_operator"&&b.value==="in"?this.negated=!1:this.negated=!0,this.range_form.triggerHandler(a,[b])},updateChart:function(){var a=this;$.map(this.chart.series[0].data,function(b,d){var e=b.name||b.category;$.inArray(a.unmap[e],a.selected)!==-1?a.negated?b.update({color:c.EXCLUDE_COLOR},!1):b.update({color:c.SELECTED_COLOR},!1):b.update({color:c.UNSELECTED_COLOR},!1)}),this.chart.redraw(),$.map(this.chart.series[0].data,function(a,b){$(a.tracker.element).mouseover(),$(a.tracker.element).mouseout()})},seriesClick:function(a){var b=a.point.category||a.point.name,c=$.inArray(this.unmap[b],this.selected);c===-1?(this.negated?a.point.update({color:d.EXCLUDE_COLOR}):a.point.update({color:d.SELECTED_COLOR}),this.selected.push(this.unmap[b])):(a.point.update({color:d.UNSELECTED_COLOR}),this.selected.splice(c,1)),this.notify(),this.updateChart(),this.chart.hoverPoint=a.point,this.chart.hoverSeries=a.point.series}}),e=d.extend({constructor:function(a,b){var d=a.data.coords,e=this.data_store={};$.each(d,function(a,b){e[b[0]]=b[1]});var f=0;$.each(d,function(a,b){f=f+b[1]});var g=f*c.MINIMUM_SLICE;$.each(d,function(a,b){b[1]<g&&(b[1]=g)}),this.base(a,b)},render:function(){this.dom=$('<div class="chart"></div>'),this.options.chart.renderTo=this.dom.get(0);var a=this;this.options.tooltip.formatter=function(){return""+a.data_store[a.unmap[this.point.name]]},this.options.chart.defaultSeriesType="pie",this.options.series[0].name=this.viewset.data.title,this.options.series[0].data=this.viewset.data.coords,this.options.title.text=this.viewset.data.title,this.options.plotOptions.series.events.click=$.proxy(this.seriesClick,this),this.chart=new Highcharts.Chart(this.options)},gainedFocus:function(a){this.base(),this.negated=!1}}),f=d.extend({render:function(){var a=this;this.dom=$('<div class="chart"></div>'),this.options.chart.marginBottom=this.viewset.data.coords.length>6?100:50,this.options.chart.renderTo=this.dom.get(0),this.options.chart.defaultSeriesType="column",this.options.chart.events.redraw=$.proxy(this.redraw,this),this.options.chart.events.load=$.proxy(this.load,this),this.options.plotOptions.series.events.click=$.proxy(this.seriesClick,this),this.options.title.text=this.viewset.data.title,this.options.series[0].name=this.viewset.data.title,this.options.series[0].data=$.map(this.viewset.data.coords,function(a,b){return a[1]}),this.options.tooltip={formatter:function(){return this.point.category+", "+this.y}},this.options.xAxis={categories:$.map(this.viewset.data.coords,function(a,b){return a[0]}),title:{text:this.viewset.data.xaxis,margin:this.viewset.data.coords.length>6?90:50},labels:{align:this.viewset.data.coords.length>6?"left":"center",y:this.viewset.data.coords.length>6?10:20,rotation:this.viewset.data.coords.length>6?50:0,formatter:function(){var b=this.value;a.viewset.data.coords.length>6?b.length>20&&(b=b.substr(0,18)+".."):b=this.value.split(" ").join("<br/>");return b}}},this.options.yAxis={min:0,title:{text:this.viewset.data.yaxis},labels:{rotation:45}},this.chart=new Highcharts.Chart(this.options)},redraw:function(a){for(var b=0;b<this.chart.series[0].data.length;b++){var c=this.chart.series[0].data[b];$(c.dataLabel.element).unbind(),$(c.dataLabel.element).attr("fill",c.color),$(c.dataLabel.element).css("color",c.color),$(c.dataLabel.element).hover(function(a){$(this).css("cursor","pointer")},function(a){$(this).css("cursor","")});var d=this;$(c.dataLabel.element).click(function(a){return function(b){a.series.chart.hoverPoint=a,a.series.chart.isDirty=!0;var c=$.inArray(d.unmap[a.category],d.selected);c===-1?d.selected.push(d.unmap[a.category]):d.selected.splice(c,1),d.notify(),d.updateChart()}}(c))}}}),g=c.extend({constructor:function(b,c){var d=this.range_form=(new a({fields:[b.data]},c)).dom;this.base(b,c);var e=this.extremes=this.chart.xAxis[0].getExtremes(),f=e.max-e.min,g=1/3*f;$("input[name*=input0]",d).val((e.min+g).toFixed(1)),$("input[name*=input1]",d).val((e.min+2*g).toFixed(1)),this.range_form.bind("ElementChangedEvent",$.proxy(this.manual_field_handler,this)),this.manual_field_handler(null)},render:function(){this.range_form.find("input").css("margin","10px");var a=this.dom=$('<div class="chart"></div>');this.options.chart.renderTo=a.get(0),this.options.chart.defaultSeriesType="line",this.options.chart.zoomType="x",this.options.title.text=this.viewset.data.title,this.options.chart.events.selection=$.proxy(this.chartSelection,this),this.options.chart.events.click=$.proxy(this.chartClick,this),this.options.plotOptions.series.point.events.click=$.proxy(this.pointClick,this),this.options.series[0].name=this.viewset.data.title,this.options.series[0].data=this.viewset.data.coords,this.options.tooltip.formatter=function(){return""+this.y},this.options.xAxis={maxPadding:.05,startOnTick:!1,title:{text:this.viewset.data.xaxis},labels:{align:"center",y:20}},this.options.yAxis={min:0,title:{style:{fontWeight:"bold"},text:this.viewset.data.yaxis,rotation:270},labels:{rotation:45}},this.chart=new Highcharts.Chart(this.options),this.dom.append(this.range_form)},manual_field_handler:function(a){var b=null,d=this.chart.options,e=parseFloat($("input[name*=input0]",this.range_form).val()).toFixed(1),f=parseFloat($("input[name*=input1]",this.range_form).val()).toFixed(1);switch(this.range_form.find("select[name*=operator]").val()){case"range":b=c.INCLUDE_COLOR;case"-range":b=b||c.EXCLUDE_COLOR,d.chart.zoomType!=="x"&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="x",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),e&&f&&this.chart.xAxis[0].addPlotBand({from:e,to:f,color:b}),this.dom.trigger("ShowDependentsEvent");break;case"lt":b=c.INCLUDE_COLOR,d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),e&&(this.chart.xAxis[0].addPlotLine({value:e,color:c.EXCLUDE_COLOR,width:3}),this.chart.xAxis[0].addPlotBand({from:this.extremes.min,to:e,color:b})),this.dom.trigger("ShowDependentsEvent");break;case"gt":b=c.INCLUDE_COLOR,d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),e&&(this.chart.xAxis[0].addPlotLine({value:e,color:c.EXCLUDE_COLOR,width:3}),this.chart.xAxis[0].addPlotBand({from:e,to:this.extremes.max,color:b})),this.dom.trigger("ShowDependentsEvent");break;case"lte":b=c.INCLUDE_COLOR,d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),e&&this.chart.xAxis[0].addPlotBand({from:this.extremes.min,to:e,color:b}),this.dom.trigger("ShowDependentsEvent");break;case"gte":b=c.INCLUDE_COLOR,d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),e&&this.chart.xAxis[0].addPlotBand({from:e,to:this.extremes.max,color:b}),this.dom.trigger("ShowDependentsEvent");break;case"exact":b=c.INCLUDE_COLOR,d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),e&&this.chart.xAxis[0].addPlotLine({value:e,color:c.INCLUDE_COLOR,width:3}),this.dom.trigger("ShowDependentsEvent");break;case"-exact":b=c.INCLUDE_COLOR,d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),e&&this.chart.xAxis[0].addPlotLine({value:e,color:c.EXCLUDE_COLOR,width:3}),this.dom.trigger("ShowDependentsEvent");break;case"isnull":b=c.EXCLUDE_COLOR,d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.chart.xAxis[0].removePlotBand(),this.chart.xAxis[0].addPlotLine({from:this.extremes.min,to:this.extremes.max,color:b}),this.dom.trigger("HideDependentsEvent");break;case"-isnull":d.chart.zoomType!==""&&(this.range_form.detach(),this.chart.destroy(),d.chart.zoomType="",d.plotOptions.line.animation=!1,this.chart=new Highcharts.Chart(d),this.dom.append(this.range_form)),this.dom.trigger("ShowDependentsEvent"),this.chart.xAxis[0].removePlotBand()}},updateDSEvent:function(a,b){this.range_form.triggerHandler(a,[b])},elementChanged:function(){},updateElement:function(a,b){this.range_form.triggerHandler(a,[b])},registerElements:function(a){$("select",this.range_form).change()},gainedFocus:function(a){this.base(),this.range_form.triggerHandler(a)},chartSelection:function(a){var b=a.target,c=this.range_form.find("select[name*=operator]").val()==="-range"?g.EXCLUDE_COLOR:g.INCLUDE_COLOR,d=a.xAxis[0].min,e=a.xAxis[0].max;d=d<this.extremes.min?this.extremes.min:d,e=e>this.extremes.max?this.extremes.max:e,d=parseFloat(d).toFixed(1),e=parseFloat(e).toFixed(1),$("input[name*=input0]",this.range_form).val(d).change(),$("input[name*=input1]",this.range_form).val(e).change(),a.preventDefault()},chartClick:function(a){var b=a.target;if(!this.chart.options.chart.zoomType){var c=a.xAxis[0].value;c=c<this.extremes.min?this.extremes.min:c,c=parseFloat(c).toFixed(1),$("input[name*=input0]",this.range_form).val(c).change()}},pointClick:function(a){if(!this.chart.options.chart.zoomType){var b=a.target.x;b=b<this.extremes.min?this.extremes.min:b,b=parseFloat(b).toFixed(1),$("input[name*=input0]",this.range_form).val(b).change()}}});return{BarChart:f,LineChart:g,PieChart:e}}),define("utils/frontdesk",["require","exports","module"],function(){function a(a){function l(){var a=0;for(var c in f)f[c]==="in"&&a++;return a+b}function k(a,b,c){var d=g[a];typeof b==="function"?b.apply(b,c):(typeof b==="string"||b instanceof String)&&d[b].apply(d,c)}function j(a){if(a&&typeof a==="object"&&typeof a.length==="number"&&!a.propertyIsEnumerable("length"))return!0;return!1}var b=0,c=[],d=[],e={},f={},g={},h=null,i=j(a);this.onEmpty=function(a){c.push(a)},this.onFull=function(a){d.push(a)},this.checkIn=function(c,h){var j,k=!1;if(c!==undefined){if(f[c]!=="in"){e[c]=[],f[c]="in",h!==undefined&&(g[c]=h),k=!0;if(i)for(j in a)if(f[j]!=="in"){k=!1;break}}}else b++;(l()===a||k)&&$.each(d,function(a,b){b()});return h},this.checkOut=function(a,d){if(l()!==0){if(a===undefined)b--;else if(f[a]==="in"){f[a]="out",d!==undefined&&(g[a]=d);for(var h=0,i=e[a].length;h<i;h++)k(a,e[a][h][0],e[a][h][1])}l()===0&&$.each(c,function(a,b){b()})}},this.leaveMessage=function(a,b){var c=Array.prototype.slice.call(arguments,2);f[a]==="in"?e[a].push([b,c]):k(a,b,c)}}return a}),define("define/view",["define/chart","define/form","utils/frontdesk","lib/base"],function(a,b,c){var d=Base.extend({constructor:function(a,b){this.viewset=a,this.fd=new c,this.view=$('<div class="view"></div>'),this.name=b;var d=this.view,e=$(this);d.bind("UpdateElementEvent",jQuery.proxy(this.updateElement,this)),d.bind("HideDependentsEvent ShowDependentsEvent",jQuery.proxy(this.toggleDependents,this)),d.bind("UpdateQueryButtonClicked",jQuery.proxy(this.constructQuery,this)),d.bind("UpdateDSEvent GainedFocusEvent LostFocusEvent RegisterElementsEvent",jQuery.proxy(this.notifyChildren,this)),$(this).bind("UpdateQueryButtonClicked GainedFocusEvent LostFocusEvent UpdateQueryButtonClicked HideDependentsEvent RegisterElementsEvent ShowDependentsEvent UpdateDSEvent",jQuery.proxy(this.eventPassThru,this)),this.render()},render:function(){var c=this.viewset,e=this.view,f=this.fd;c.elements[0].type!=="chart"&&e.append("<h2>"+this.name+"</h2>"),$.each(this.viewset.elements,function(g,h){var i=null;switch(h.type){case"form":i=new b(h,c.concept_id),e.append(i.dom),f.checkIn(g,i.dom),f.checkOut(g);break;case"chart":var j=h.data.datatype;j==="number"?(i=new a.LineChart(h,c.concept_id),e.append(i.dom),f.checkIn(g,i.dom),f.checkOut(g)):j==="nullboolean"||j==="boolean"?(i=new a.PieChart(h,c.concept_id),e.append(i.dom),f.checkIn(g,i.dom),f.checkOut(g)):(i=new a.BarChart(h,c.concept_id),e.append(i.dom),f.checkIn(g,i.dom),f.checkOut(g));break;case"custom":h.css&&d.loadCss(h.css),f.checkIn(g);var k=c.elements[0].type==="chart"?0:1;require([h.js],function(a){var b=new a(h,c.concept_id);e.children().length-1<g+k?e.append(b.dom):$(e.children()[g]).prepend(b.dom),f.checkOut(g,b.dom)});break;default:e.append($("<p>Undefined View!</p>"))}})},updateElement:function(a){var b=this.fd;$.each(this.viewset.elements,function(c){b.leaveMessage(c,"triggerHandler",a)}),a.stopPropagation()},toggleDependents:function(a){var b=this.fd;a.target===this.view.children().get(0)&&$.each(this.viewset.elements,function(c){c!==0&&b.leaveMessage(c,"triggerHandler",a)}),a.stopPropagation()},constructQuery:function(a){this.view.trigger("ConstructQueryEvent"),a.stopPropagation()},notifyChildren:function(a,b){var c=this.fd;$.each(this.viewset.elements,function(d){c.leaveMessage(d,"triggerHandler",a,b)}),a.stopPropagation()},eventPassThru:function(a,b){this.view.triggerHandler(a,b),a.stopPropagation()},dom:function(){return this.view}},{loadCss:function(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.href=a,document.getElementsByTagName("head")[0].appendChild(b)}});return d}),define("define/conceptmanager",["define/view"],function(a){var b;$(function(){var c=$("#plugin-panel"),d=$("#plugin-title"),e=$("#plugin-tabs"),f=$("#plugin-dynamic-content"),g=$("#plugin-static-content");b=function(){function M(a,c,d,e){parseInt(a.id)!==i&&(c&&(a.query=c),i!==null&&(b[i]["static"]=g.children().detach()),b[a.id]&&b[a.id].globalsLoaded?J(a):I(a,J))}function L(a){b[a.id]===undefined?b[a.id]=a:($.extend(b[a.id],a),a=b[a.id]),a.ds||(a.query?a.ds=y(a.query):a.ds={}),a.invalid_fields||(a.invalid_fields={});return a}function K(a,b){var c=e.children().index(b);e.trigger("ShowViewEvent",c)}function J(a){a=L(a),i=parseInt(a.id),a.globalsLoaded=!0,a.views.length<2?e.hide():e.show();var b=$.jqote(d,a.views);e.html(b),a["static"]?(g.append(a["static"]),k=g.find("#add_to_query")):(g.append(h),k=g.find("#add_to_query"),k.click(function(){var a=$.Event("UpdateQueryButtonClicked");$(this).trigger(a);return!1})),$.inArray(i,l)<0?(k.html('<span class="icon plus"/> <span>Add Condition</span>'),$(".success",g).hide()):(k.html('<span class="icon refresh"/> <span>Update Condition</span>'),$(".success",g).show()),e.children(":first").click()}function I(b,c){c=c||function(){},b.css&&a.loadCss(b.css),b.js?require([b.js],function(a){c(b)}):c(b)}function H(a){a.reason=a.reason?"_"+a.reason:"";var c=b[i].invalid_fields,d=$(a.target).attr("name");$.each(b[i].views,function(b,c){c.contents&&c.contents.dom().find("[name="+d+"]").removeClass("invalid"+a.reason),c.contents&&c.contents.dom().find("[name="+d+"]").children().removeClass("invalid"+a.reason)});var e=c[d+a.reason].data("ref_count")-1;e===0?c[d+a.reason].remove():c[d+a.reason].data("ref_count",e),delete b[i].invalid_fields[d+a.reason],$.isEmptyObject(b[i].invalid_fields)&&g.find("#add_to_query").attr("disabled","")}function G(a){a.reason=a.reason?"_"+a.reason:"";var c=b[i].invalid_fields,d=$(a.target).attr("name");$.each(b[i].views,function(b,c){c.contents&&c.contents.dom().find("[name="+d+"]").addClass("invalid"+a.reason),c.contents&&c.contents.dom().find("[name="+d+"]").children().addClass("invalid"+a.reason)});var e=a.message?a.message:"This query contains invalid input, please correct any invalid fields.",f=!1;$.each(g.find(".error"),function(b,g){g=$(g);var h=g.data("ref_count");if(g.text()===e){f=!0;if(a.ephemeral)return;if(c[d+a.reason]===undefined)c[d+a.reason]=g,g.data("ref_count",h+1);else if(g.text()!==c[d+a.reason].text()){var i=c[d+a.reason].data("ref_count");c[d+a.reason].data("ref_count",i-1),c[d+a.reason].data("ref_count")===0&&c[d+a.reason].remove(),c[d+a.reason]=g,g.data("ref_count",h+1)}}});if(!f){var h=$('<div class="message error">'+e+"</div>");h.data("ref_count",1),a.ephemeral||(c[d+a.reason]=h),g.prepend(h),a.ephemeral?h.fadeOut(3e3,function(){h.remove()}):g.find("#add_to_query").attr("disabled","true")}}function F(a){$(j.contents).triggerHandler("UpdateQueryButtonClicked")}function E(a,c){c=c||b[i].ds;if(!D(c)){var d=$.Event("InvalidInputEvent");d.ephemeral=!0,d.message="No value has been specified.",$(a.target).trigger(d);return!1}var e=x(c);$(a.target).trigger("UpdateQueryEvent",[e]);return!0}function D(a){var b=!1;if($.isEmptyObject(a))b=!0;else{b=!0;for(var c in a){if(!a.hasOwnProperty(c))continue;if(o.test(c)){if(a[c]&&a[c].indexOf("isnull")>=0){b=!1;break}}else if(p.test(c)||n.test(c)||m.test(c)){b=!1;break}}}if(b)return!1;for(var c in a){if(!a.hasOwnProperty(c))continue;if(a[c]===undefined||a[c]==="")return!1;if($.isArray(a[c])&&a[c].length===0)return!1}return!0}function C(a,c){var d=b[i].ds,e=!1;if(c.value instanceof Array||d[c.name]!==c.value){if(c.value instanceof Array&&d[c.name]instanceof Array){for(var f=0;f<c.value.length;f++)if($.inArray(c.value[f],d[c.name])==-1){e=!0;break}if(e===!1&&c.value.length==d[c.name].length)return}c.value===undefined?delete b[i].ds[c.name]:b[i].ds[c.name]=c.value instanceof Array?c.value.slice(0):c.value,$.each(b[i].views,function(a,b){j!==b&&b.contents&&b.contents.trigger("UpdateElementEvent",[c])})}}function B(a,b){}function A(d,e){j!==null&&(j.contents.dom().css("display","none"),$(j.contents).trigger("LostFocusEvent"),j.contents.dom().detach()),j=b[i].views[e];if(j.loaded)z(null,j.contents);else{var f=null;j.concept_id=i,c.trigger("ViewReadyEvent",[new a(j,b[i].name)])}}function z(a,c){j.contents=c;var d=j.contents.dom();f.append(d),d.css("display","block"),$(".chart",j.contents).css("display","block"),j.loaded||($(c).trigger("UpdateDSEvent",[b[i].ds]),$(c).trigger("RegisterElementsEvent")),$(c).trigger("GainedFocusEvent"),j.loaded=!0}function y(a,b){var c=b||{},d,e;if(a.hasOwnProperty("type"))$.each(a.children,function(a,b){y(b,c)});else{a.hasOwnProperty("id_choices")?(e=a.id_choices.join("OR"),c[e]=a.id):e=a.id,d=a.concept_id+"_"+e;if(!a.operator.match(/null/))if(a.datatype in{number:1,date:1}){var f=a.value instanceof Array?a.value:[a.value];for(var g=0;g<f.length;g++)c[d+"_input"+g]=f[g]}else c.hasOwnProperty(d)?c[d]instanceof Array?c[d].push(a.value):(c[d]=[c[d]],c[d].push(a.value)):c[d]=a.value;c[d+"_operator"]=c[d]instanceof Array&&a.datatype&&a.datatype.indexOf("boolean")>=0?s[a.operator]:a.operator}return c}function x(a){var b={};for(var c in a){if(!a.hasOwnProperty(c))continue;var d=n.exec(c);if(d){b.hasOwnProperty(d[2])?$.extend(b[d[2]],{val0:a[c],val1:undefined,op:undefined}):b[d[2]]={val0:a[c],val1:undefined,op:undefined};continue}d=m.exec(c);if(d){b.hasOwnProperty(d[2])?b[d[2]]["val"+d[3]]=Number(a[c])||a[c]:(b[d[2]]={val0:undefined,val1:undefined,op:undefined},b[d[2]]["val"+d[3]]=Number(a[c])||a[c]);continue}d=p.exec(c),d&&(b.hasOwnProperty(d[0])?b[d[0]].pk=a[c]:b[d[0]]={val0:undefined,val1:undefined,op:undefined,pk:a[c]})}for(c in a){if(!a.hasOwnProperty(c))continue;d=o.exec(c),d&&(b[d[2]]||a[c].match(/null/))&&(b.hasOwnProperty(d[2])||(b[d[2]]={val0:undefined,val1:undefined,op:undefined}),b[d[2]].op=a[c])}var e=[];for(var f in b){var g=b[f],h=!1,k=null;p.exec(f)&&(k=f.split("OR"),f=g.pk,h=!0),f=Number(f);if(g.val0===undefined&&g.val1===undefined&&g.op!==undefined)e.push({operator:g.op,id:f,concept_id:i,value:!0,datatype:w(f)});else if(g.val0!==undefined&&g.val1!==undefined&&g.op!==undefined)e.push({operator:g.op,id:f,value:[g.val0,g.val1],concept_id:i,datatype:w(f)});else if(g.val0===undefined||g.op===undefined||g.val0 instanceof Array)if(g.val0!==undefined&&g.val0 instanceof Array){g.op=g.op!==undefined?g.op:"in";var l=w(f);switch(l){case"boolean":case"nullboolean":var s=[],u=r[g.op];$.each(g.val0,function(a,b){s.push({operator:u,id:f,value:t[b]!==undefined?t[b]:b,concept_id:i,datatype:l})}),s.length>1?e.push({type:q.test(g.op)?"and":"or",children:s,concept_id:i}):e.push(s[0]);break;default:e.push({operator:g.op,id:f,value:g.val0,concept_id:i})}}else{if(g.val0===undefined||g.val0 instanceof Array||g.val1!==undefined)throw"Unable to determine field "+g+" in concept "+i;e.push({operator:"exact",id:f,value:g.val0,concept_id:i})}else e.push({operator:g.op,id:f,value:g.val0,concept_id:i,datatype:w(f)});h&&(e[e.length-1].id_choices=k)}var v;e.length===1?v=e[0]:v={type:j.join_by||"and",children:e,concept_id:i};return v}function w(a){var b=j.elements,c=null;$.each(b,function(b,d){if(d.type==="custom")return d.datatype;if(d.data){if(d.data.pk==a){c=d.data.datatype;return!1}if(d.data.pkchoices&&$.inArray(a,$.map(d.data.pkchoices,function(a,b){return a[0]}))>=0){c=d.data.datatype;return!1}}else{$.each(d.fields,function(b,d){if(d.pk==a){c=d.datatype;return!1}if(d.pkchoices&&$.inArray(a,$.map(d.pkchoices,function(a,b){return a[0]}))>=0){c=d.datatype;return!1}});if(c!==null)return!1}});return c}function v(a){var b=$.inArray(parseInt(a.concept_id),l);b>=0&&(l.splice(b,1),i===parseInt(a.concept_id)&&(k.html('<span class="icon plus"/> <span>Add Condition</span>'),$(".success",g).hide())),a.stopPropagation()}function u(a){$.inArray(a.concept_id,l)<0&&(l.push(parseInt(a.concept_id)),i===parseInt(a.concept_id)&&(k.html('<span class="icon refresh"/> <span>Update Condition</span>'),$(".success",g).show())),a.stopPropagation()}var b={},d='<a class="tab" href="#"><%= this.tabname %></a> ',h=['<div class="message success">Condition has been added.</div>','<button id="add_to_query"></button>'].join(""),i=null,j=null,k=null,l=[],m=/^(\d+)_(\d+(?:OR\d+)*)_input([01])$/,n=/^(\d*)_(\d+(?:OR\d+)*)$/,o=/^(\d*)_(\d+(?:OR\d+)*)_operator$/,p=/^\d+(?:OR\d+)+$/,q=/-/,r={"in":"exact","-in":"-exact",exact:"exact","-exact":"-exact"},s={exact:"in","-exact":"-in"},t={"true":!0,"false":!1,"null":null};c.bind({ViewReadyEvent:z,ViewErrorEvent:B,ShowViewEvent:A,ElementChangedEvent:C,UpdateQueryButtonClicked:F,InvalidInputEvent:G,InputCorrectedEvent:H,ConstructQueryEvent:E,ConceptDeletedEvent:v,ConceptAddedEvent:u}),e.bind("ConceptTabClickedEvent",K),e.tabs(!0,function(a,b){b.trigger("ConceptTabClickedEvent",b)});return{show:M,isConceptLoaded:function(a){return a in b},buildQuery:x,constructQueryHandler:E}}()});return b}),define("define/criteria",function(){var a=$.jqotec(['<div data-uri="<%=this.uri%>" data-id="<%= this.pk %>" class="criterion clearfix">','<a href="#" class="remove-criterion"></a>','<a href="#" class="field-anchor">',"<%= this.description %>","</a>","</div>"].join("")),b=function(b,c,d){var e=$($.jqote(a,{pk:b.concept_id,description:d,uri:c+b.concept_id}));e.data("constraint",b),e.find(".remove-criterion").click(function(){e.trigger("CriteriaRemovedEvent");return!1}),e.click(function(a){e.trigger("activate-criterion",[b.concept_id]);return!1});return e};return{Criteria:b}}),define("define/criteriamanager",["define/criteria"],function(a){var b='<button id="submit-query"><span class="icon arrow-r"/> <span>Get Report</span></button>',c;$(function(){var d=$("#user-criteria");c=function(){var c={},e=d.find("#criteria-list"),f=d.find(".content"),g=d.find("#remove-criteria"),h=e.attr("data-uri"),i=e.attr("data-report"),j=d.attr("data-uri"),k=e.children(),l=$(b);$.getJSON(j,function(a){a.store!==null&&!$.isEmptyObject(a.store)&&(a.store.hasOwnProperty("concept_id")?d.triggerHandler("UpdateQueryEvent",[a.store,!0]):$.each(a.store.children.reverse(),function(a,b){d.triggerHandler("UpdateQueryEvent",[b,!0])}))}),l.click(function(){var a=[],b;for(var d in c)c.hasOwnProperty(d)&&a.push(c[d].data("constraint"));a.length<2?b=a[0]:b={type:"and",children:a},$.putJSON(j,JSON.stringify(b),function(){window.location=i})}),g.click(function(){for(var a in c)c.hasOwnProperty(a)&&c[a].trigger("CriteriaRemovedEvent")}),d.bind("UpdateQueryEvent",function(b,g,i){var j=g.concept_id,m;$.isEmptyObject(c)&&(k.detach(),f.append(l)),l.attr("disabled","true"),$.postJSON(h,JSON.stringify(g),function(b){l.removeAttr("disabled");var f=$.isEmptyObject(c);if(c.hasOwnProperty(j))m=a.Criteria(g,h,b),c[j].replaceWith(m),m.fadeTo(300,.5,function(){m.fadeTo("fast",1)});else{m=a.Criteria(g,h,b),i?e.prepend(m):e.append(m);var k=$.Event("ConceptAddedEvent");k.concept_id=j,d.trigger(k)}c[j]=m,i||(m.addClass("selected"),m.siblings().removeClass("selected")),f&&$(e.children()[0]).find(".field-anchor").click()},"text")}),d.bind("CriteriaRemovedEvent",function(a){var b=$(a.target),f=b.data("constraint");c[f.concept_id].remove(),delete c[f.concept_id];var g=$.Event("ConceptDeletedEvent");g.concept_id=f.concept_id,d.trigger(g),$.isEmptyObject(c)&&(e.append(k),l.detach())}),d.bind("ShowConceptEvent",function(a){var b=$(a.target);e.children(".criterion").removeClass("selected");if(b.is(".criterion"))b.addClass("selected");else{var d=a.originalEvent.concept_id;c[d]&&c[d].addClass("selected")}});return{retrieveCriteriaDS:function(a){var b=null;a&&$.each(e.children(),function(c,d){$(d).data("constraint")&&($(d).data("constraint").concept_id==a&&(b=$(d).data("constraint")))});return b}}}()});return c}),define("define/description",["define/events"],function(a){$(function(){var b={description:$('<div id="description"></div>').appendTo("body")};b.description.timeout=null,b.description.bind(a.ACTIVATE_DESCRIPTION,function(a){clearTimeout(b.description.timeout);var c,d,e=$(a.target),f=e.offset(),g=e.outerWidth(),h=e.children(".description").html();b.description.html(h),c=b.description.outerHeight(),d=$(window).height()-(c+f.top),b.description.css({left:f.left+g+20,top:f.top+(d<0?d:0)}).show();return!1}),b.description.bind(a.DEACTIVATE_DESCRIPTION,function(a,c){c=c||0,b.description.timeout=setTimeout(function(){b.description.fadeOut(100)},c);return!1}),b.description.bind({mouseover:function(){clearTimeout(b.description.timeout)},mouseout:function(){b.description.trigger(a.DEACTIVATE_DESCRIPTION,[200])}})})}),define("define/criteria2",["define/events","rest/resource","define/conceptmanager","define/criteriamanager","define/description"],function(a,b,c,d){var e=['<div data-id="<%= this.id %>">','<span class="name"><%= this.name %></span>','<span class="description"><%= this.description %></span>',"</div>"].join(""),f;$(function(){var g={criteria:$("#criteria"),pluginPanel:$("#plugin-panel")};f=(new b({url:g.criteria.data("uri"),template:e})).ready(function(){g.criteria.html(this.dom)}),g.criteria.current=null,g.criteria.bind(a.ACTIVATE_CATEGORY,function(a,b){f.ready(function(){$.each(this.store,function(){this.data("category").id===b?this.show():this.hide()})})}),g.criteria.bind(a.ACTIVATE_CRITERION+" ShowConceptEvent",function(b,e){if(g.criteria.current===e)return!1;g.criteria.current=e,f.ready(function(){var b=this.store[e];b.addClass("active"),b.siblings().removeClass("active");var f=b.data();g.criteria.trigger(a.SYNC_CATEGORY,[f.category.id,e]);var h=d.retrieveCriteriaDS(e);c.isConceptLoaded(e)?c.show({id:e},h):$.ajax({url:b.data("uri"),dataType:"json",beforeSend:function(){g.pluginPanel.block()},complete:function(){g.pluginPanel.unblock()},success:function(a){c.show(a,h)}})})});var h=null;g.criteria.delegate("div","mouseenter",function(){clearTimeout(h);var b=this;h=setTimeout(function(){$(b).trigger(a.ACTIVATE_DESCRIPTION,["right"])},700)}),g.criteria.delegate("div","mouseleave",function(){clearTimeout(h),$(this).trigger(a.DEACTIVATE_DESCRIPTION,[200])}),g.criteria.delegate("div","click",function(b){clearTimeout(h),$(this).trigger(a.ACTIVATE_CRITERION,[$(this).data("id")]),$(this).trigger(a.DEACTIVATE_DESCRIPTION)})});return f}),define("define/search",["define/events","define/criteria2","rest/resource"],function(a,b,c){var d=['<div data-id="<%= this.id %>">',"<b><%= this.name %></b><br>","<span><%= this.category.name %></span>","</div>"].join(""),e;$(function(){function g(){var a=f.results.outerWidth(),b=f.search.offset(),c=f.search.outerHeight(),d=f.search.outerWidth();f.results.css({left:b.left-(a-d)/2,top:b.top+c+5})}var f={search:$("#search"),results:$('<div id="search-results"></div>').appendTo("body"),noresults:$('<p style="font-style:italic">No Results Found</p>')};b.ready(function(){e=(new c({store:b._,template:d})).ready(function(){f.results.html(this.dom),g()}),f.search.autocomplete2({success:function(a,b){f.noresults.detach(),f.results.show().children().hide(),b.length?$.each(b,function(){e.store[this]&&e.store[this].show()}):f.noresults.prependTo(f.results)}},null,50)}),f.results.entered=!1,f.search.bind({blur:function(a){f.search.focused=!1,f.results.entered||f.results.trigger("mouseleave")},focus:function(a){f.search.focused=!0;var b=f.search.val();b&&b!==f.search.attr("placeholder")&&f.results.fadeIn("fast")}}),f.results.bind({mouseenter:function(a){f.results.entered=!0},mouseleave:function(a){f.results.entered=!1,f.search.focused||f.results.fadeOut("fast")}}),f.results.delegate("div","click",function(b){var c=$(this);c.trigger(a.ACTIVATE_CRITERION,[c.data("id")])}),$(window).bind("resize",function(a){g()})});return e}),define("utils/html5fix",function(){$(function(){Modernizr.input.placeholder||$("input[placeholder]").placeholder(),Modernizr.input.autofocus||$("input[autofocus]").focus()})});var OVERLAY=$("#overlay");$("body").bind({ajaxComplete:function(a,b,c){if(b.status===302){var d=$.parseJSON(b.responseText);d.redirect&&(window.location=d.redirect)}},ajaxError:function(a,b,c,d){}}),define("utils/ajaxsetup",function(){}),Array.prototype.map||(Array.prototype.map=function(a){var b=this.length>>>0;if(typeof a!="function")throw new TypeError;var c=Array(b),d=arguments[1];for(var e=0;e<b;e++)e in this&&(c[e]=a.call(d,this[e],e,this));return c}),function(a){a.extend({putJSON:function(b,c,d,e){return a.ajax({type:"PUT",url:b,contentType:"application/json",data:c,success:d,dataType:e})},postJSON:function(b,c,d,e){return a.ajax({type:"POST",url:b,contentType:"application/json",data:c,success:d,dataType:e})},log:function(a){window.console?console.log(a):alert(a)},jqoteobj:function(b,c,d){out=a.jqote(b,c,d);return a(out)}}),a.fn.placeholder=function(b){var c=this;c.each(function(){var d=a(this),e=d.css("color");b=b||d.attr("placeholder");if(!d.is("input")&&!d.is("textarea"))return c;(d.val()===""||d.val()===b)&&d.val(b).css("color","#999"),d.focus(function(){d.val()===b&&d.css("color",e).val("")}).blur(function(){d.css("color",e),d.val()===""&&d.css("color","#999").val(b)})});return this},a.fn.jdata=function(b,c){var d=a.grep(this,function(d){return a(d).data(b)==c});return a(d)},a.fn.autocomplete2=function(b,c,d,e){if(!this.is("input[type=text]")&&!this.is("input[type=search]"))throw new TypeError("A text or search field is required");c=c||null,d=d||300,e=e||!1;var f=a.extend({},b),g=f.success||function(){},h=f.error||function(){},i=f.start||function(){},j=f.end||function(){};f.data={};return this.each(function(b){var k=a(this),l,m,n,o=null,p=null,q=null,r=!1;l=k.closest("form").submit(function(a){return!1}),f.url=l.attr("action"),f.success=function(a,b,c){g(m,a,b,c),q==null&&e&&(q={resp:a,status:b,xhr:c}),n&&b=="success"&&(k.cache[m]=a),o=m,r=!1,f.end()},f.error=function(a,b,c){h(m,a,b,c),f.end()},f.start=function(){r=!0,i(m)},f.end=function(){r=!1,j()};var s="search-"+b;k.cache={},k.bind(s,function(b,g,h){n=h?!0:!1,m=g;n&&k.cache[m]?f.success(k.cache[m],"cached",null):(clearTimeout(p),c!==null&&m===c&&(m=""),m=m||"",m=SearchSanitizer.clean(m).toLowerCase(),m!==o?(r==!1&&f.start(),f.data.q=m,p=setTimeout(function(){e&&q?f.success(q.resp,q.status,q.xhr):a.ajax(f)},d)):f.end())}),k.keyup(function(a){k.trigger(s,[this.value]);return!1})})},a.fn.tabs=function(){var b={nextTab:function(a,b,c,d){b=b===undefined?a.data("tabindex"):b,c=c||a.attr("children").length,d=d===undefined?0:d+1;if(d==c)return null;if(c+1<=b)return this.nextTab(a,0,c,d);if(a.children(":nth("+b+")").hasClass("disabled"))return this.nextTab(a,b+1,c,d);return b},getTab:function(a,b){return a.children(":nth("+b+")")}},c={init:function(b,c,e){b.data("tabified",!0),c=c===!0?!0:!1,e=e||function(){};var f=b.children(".tab");c?a(".tab",b).live("click",d(e)):f.click(d(e)),f.filter(".active").length===0&&f.not(".disabled").filter(":first").click()},toggle:function(a,c){b.getTab(a,c).click(),a.data("tabindex",c)},disable:function(a,c){b.getTab(a,c).addClass("disabled").removeClass("active"),nindex=b.nextTab(a,c),nindex!==null&&this.toggle(a,nindex)},enable:function(a,c){b.getTab(a,c).removeClass("disabled")}},d=function(b){return function(c){c.preventDefault();var d=a(this).not(".disabled");if(d.length==0||d.hasClass("active"))return!1;var e=d.siblings(".tab");d.addClass("active"),e.removeClass("active"),b(c,d)}};return function(a,b){if(typeof a==="string"){if(this.data("tabified")===null)throw new TypeError("tabs have not been initialized yet");c[a](this,b)}else c.init(this,a,b);return this}}()}(jQuery),define("utils/extensions",function(){});var SearchSanitizer={regexes:{truncateWhiteSpace:[/\s{2,}/g," "],removeNonAlphaNumeric:[/[^\sA-Za-z0-9]/g,""],removeStopWords:[/\b(a|able|about|across|after|all|almost|also|am|among|an|and|any|are|as|at|be|because|been|but|by|can|cannot|could|dear|did|do|does|either|else|ever|every|for|from|get|got|had|has|have|he|her|hers|him|his|how|however|i|if|in|into|is|it|its|just|least|let|like|likely|may|me|might|most|must|my|neither|no|nor|not|of|off|often|on|only|or|other|our|own|rather|said|say|says|she|should|since|so|some|than|that|the|their|them|then|there|these|they|this|tis|to|too|twas|us|wants|was|we|were|what|when|where|which|while|who|whom|why|will|with|would|yet|you|your)\b/g,""],trimRightWhiteSpace:[/^\s+/,""],trimLeftWhiteSpace:[/\s+$/,""]},clean:function(a){for(var b in this.regexes){var c=this.regexes[b];a=a.replace(c[0],c[1])}return a}};define("utils/sanitizer",function(){}),function(a){a.bubbleproxy=function(b,c){return a(c||"body").bubbleproxy(b)},a.fn.bubbleproxy=function(b){b=b||{},typeof b=="string"&&(nconfig={},nconfig[arguments[0]]=arguments[1]||{},b=nconfig);var c=this;a.each(b,function(b,d){if(d.listeners){var e=a.map(d.listeners||[],function(b){return b.jquery?b:a(b)}),f=a.map(d.sources||[],function(a){return a.jquery?a.selector:a}),g=d.stopPropagation===undefined?!0:d.stopPropagation;c.bind(b,function(b){if(!!f.length){var c=!1,d=a(b.target);a.each(f,function(){c=!d.is(this);return c});if(!c)return}var h,i,j=Array.prototype.slice.call(arguments,1);a.each(e,function(){i=a.extend(a.Event(b.type),b),h=j.slice(0),h.unshift(i),g&&i.stopPropagation(),this.each(function(){a.event.trigger(i,h,this,!0)})})})}});return this}}(jQuery),define("lib/jquery.bubbleproxy",function(){}),require(["define/events","define/categories","define/criteria2","define/search","define/criteriamanager","utils/html5fix","utils/ajaxsetup","utils/extensions","utils/sanitizer","lib/jquery.bubbleproxy"],function(a,b,c,d,e){$(function(){var b={};b[a.ACTIVATE_CATEGORY]={listeners:["#criteria","#categories"]},b[a.ACTIVATE_CRITERION]={listeners:["#criteria"]},b[a.SYNC_CATEGORY]={listeners:["#categories"]},b[a.ACTIVATE_DESCRIPTION]={listeners:["#description"]},b[a.DEACTIVATE_DESCRIPTION]={listeners:["#description"]},b["ConceptAddedEvent ConceptDeletedEvent"]={listeners:["#plugin-panel"]},b.UpdateQueryEvent={listeners:["#user-criteria"]};var c=$("body");c.bubbleproxy(b)})}),define("define/main",function(){})