define("define/views/search",["lib/backbone"],function(){var a=Backbone.View.extend({jq:"#search",focused:!1,timer:null,events:{focus:"focus",blur:"blur",keyup:"keyup"},initialize:function(){this.render()},render:function(){this.jq=$(this.jq),this.el=this.jq[0],this.delegateEvents()},focus:function(){this.focused=!0,this.trigger("focused")},blur:function(){this.focused=!1,this.trigger("blurred")},keyup:function(){clearTimeout(this.timer);var a=this;this.timer=setTimeout(function(){a.trigger("query",[a.jq.val()])},100)}}),b=Backbone.View.extend({id:"search-results",tagName:"div",empty:$('<p style="font-style:italic">No results found</p>'),events:{mouseenter:"enter",mouseleave:"leave"},query:null,focused:!1,initialize:function(){this.render()},render:function(){this.jq=$(this.el),this.jq.appendTo("body")},enter:function(){this.focused=!0},leave:function(){this.focused=!1,this.input.focused||this.hide()},show:function(){this.jq.fadeIn("fast")},hide:function(){this.jq.fadeOut("fast")}}),c=Backbone.View.extend({query:null,initialize:function(){this.input=new a,this.results=new b({input:this.input}),this.input.bind("focused",_.bind(this.show,this)),this.input.bind("blurred",_.bind(this.hide,this)),this.input.bind("query",_.bind(this.query,this))},show:function(){this.query&&(this.setPosition(),this.results.show())},hide:function(){this.results.focused||this.results.hide()},setPosition:function(){var a=this.results.jq,b=this.input.jq,c=a.outerWidth(),d=b.offset(),e=b.outerHeight(),f=b.outerWidth();a.css({left:d.left-(c-f)/2,top:d.top+e+5})},query:function(a){var b=this;$.getJSON(this.collection.url,{q:a},function(c){b.query=a,b.show()})}});return{SearchView:c}})