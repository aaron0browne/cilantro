define(["cilantro/define/events","cilantro/rest/resource"],function(a,b){var c=['<span id="tab-<%= this.name.toLowerCase() %>" ','class="tab" data-id="<%= this.id %>">','<div class="icon"></div>',"<span><%= this.name %></span>","</span>"].join(""),d;$(function(){var e={categories:$("#categories"),subcategories:$("#subcategories")};e.categories.current=null,d=(new b({url:e.categories.data("uri"),template:c})).ready(function(){e.categories.html(this.dom),this.dom.first().click()}),e.categories.bind(a.ACTIVATE_CATEGORY,function(b,c){if(e.categories.current===c)return!1;e.categories.current=c,d.ready(function(){var b=this.store[c];b.addClass("active"),b.siblings().removeClass("active");var d=b.data("_state");!!d&&d.criterion&&e.categories.trigger(a.ACTIVATE_CRITERION,[d.criterion])})}),e.categories.bind(a.SYNC_CATEGORY,function(b,c,f){d.ready(function(){var b=this.store[c];b.data("_state",{criterion:f}),e.categories.trigger(a.ACTIVATE_CATEGORY,[c])});return!1}),e.categories.delegate("span.tab","click",function(b){$(b.currentTarget).trigger(a.ACTIVATE_CATEGORY,[$(this).data("id")])}),e.subcategories.delegate("span","click",function(a){var b=$(this);b.addClass("active").siblings().removeClass("active");return!1})});return d})