define(["cilantro/define/events","cilantro/rest/resource"],function(a,b){var c=['<span id="tab-<%= this.name.toLowerCase() %>" ','class="tab" data-id="<%= this.id %>">','<div class="icon"></div>',"<span><%= this.name %></span>","</span>"].join(""),d={categories:$("#categories"),subcategories:$("#subcategories"),pluginPanel:$("#plugin-panel")};d.categories.current=null;var e=(new b({url:d.categories.data("uri"),template:c})).ready(function(){d.categories.html(this.dom).animate({opacity:1}),this.dom.first().click()});d.categories.bind(a.ACTIVATE_CATEGORY,function(b,c){if(d.categories.current===c)return!1;d.categories.current=c,e.ready(function(){var b=this.store[c];b.addClass("active"),b.siblings().removeClass("active");var e=b.data("_state");!!e&&e.criterion?(d.pluginPanel.show(),d.categories.trigger(a.ACTIVATE_CRITERION,[e.criterion])):d.pluginPanel.hide()})}),d.categories.bind(a.SYNC_CATEGORY,function(b,c,f){e.ready(function(){var b=this.store[c];b.data("_state",{criterion:f}),d.categories.trigger(a.ACTIVATE_CATEGORY,[c])});return!1}),d.categories.delegate("span.tab","click",function(b){$(b.currentTarget).trigger(a.ACTIVATE_CATEGORY,[$(this).data("id")])}),d.subcategories.delegate("span","click",function(a){var b=$(this);b.addClass("active").siblings().removeClass("active");return!1});return e})