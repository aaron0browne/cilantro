define("define/bb/models",["lib/backbone","lib/clerk"],function(){var a=Backbone.Model.extend({defaults:{active:!1}}),b=Backbone.Collection.extend({model:a,initialize:function(){this.bind("refresh",function(){clerk.receive(this)})},updateActiveState:function(a){this.each(function(b){b.set({active:b.id===a})})}}),c=a.extend({defaults:{criterion:null},initialize:function(){a.prototype.initialize.call(this),this.bind("change:active",this.toggleCriterionActiveState),this.bind("change:active",this.filterCriteria)},toggleCriterionActiveState:function(a,b){var c=this.get("criterion");!c||c.set({active:b})},filterCriteria:function(a,b){!b||clerk.send(f,"filterByCategory",[this.id])}}),d=b.extend({url:window.__api__.categories,model:c}),e=a.extend({defaults:{visible:!0},initialize:function(){this.bind("change:active",this.setCategoryActiveState),a.prototype.initialize.call(this),clerk.send(d,function(a){a.set({category:this.get(a.get("category").id)})},[this])},setCategoryActiveState:function(){if(!!this.get("active")){var a=this.get("category");a.set({criterion:this}),clerk.send(d,"updateActiveState",[a.id])}}}),f=b.extend({url:window.__api__.criteria,model:e,initialize:function(){_.bindAll(this,"filterByCategory"),b.prototype.initialize.call(this)},filterByCategory:function(a){var b;this.each(function(c){b=c.get("category"),c.set({visible:b.id===a})})}});f=new f,d=new d;var g={CriterionCollection:f,CategoryCollection:d};return g})